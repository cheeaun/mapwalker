import{c as C,g as Ze,u as Je}from"./index.7c6184f4.js";var B=Ye,Xe=Object.prototype.hasOwnProperty;function Ye(){for(var e={},t=0;t<arguments.length;t++){var n=arguments[t];for(var r in n)Xe.call(n,r)&&(e[r]=n[r])}return e}var ve={exports:{}};(function(e,t){(function(){var n={};e.exports=n,n.simpleFilter=function(r,i){return i.filter(function(o){return n.test(r,o)})},n.test=function(r,i){return n.match(r,i)!==null},n.match=function(r,i,o){o=o||{};var s=0,u=[],a=i.length,l=0,c=0,f=o.pre||"",v=o.post||"",g=o.caseSensitive&&i||i.toLowerCase(),h;r=o.caseSensitive&&r||r.toLowerCase();for(var b=0;b<a;b++)h=i[b],g[b]===r[s]?(h=f+h+v,s+=1,c+=1+c):c=0,l+=c,u[u.length]=h;return s===r.length?(l=g===r?1/0:l,{rendered:u.join(""),score:l}):null},n.filter=function(r,i,o){return!i||i.length===0?[]:typeof r!="string"?i:(o=o||{},i.reduce(function(s,u,a,l){var c=u;o.extract&&(c=o.extract(u));var f=n.match(r,c,o);return f!=null&&(s[s.length]={string:f.rendered,score:f.score,index:a,original:u}),s},[]).sort(function(s,u){var a=u.score-s.score;return a||s.index-u.index}))}})()})(ve);var R=function(e){return this.component=e,this.items=[],this.active=0,this.wrapper=document.createElement("div"),this.wrapper.className="suggestions-wrapper",this.element=document.createElement("ul"),this.element.className="suggestions",this.wrapper.appendChild(this.element),this.selectingListItem=!1,e.el.parentNode.insertBefore(this.wrapper,e.el.nextSibling),this};R.prototype.show=function(){this.element.style.display="block"};R.prototype.hide=function(){this.element.style.display="none"};R.prototype.add=function(e){this.items.push(e)};R.prototype.clear=function(){this.items=[],this.active=0};R.prototype.isEmpty=function(){return!this.items.length};R.prototype.isVisible=function(){return this.element.style.display==="block"};R.prototype.draw=function(){if(this.element.innerHTML="",this.items.length===0){this.hide();return}for(var e=0;e<this.items.length;e++)this.drawItem(this.items[e],this.active===e);this.show()};R.prototype.drawItem=function(e,t){var n=document.createElement("li"),r=document.createElement("a");t&&(n.className+=" active"),r.innerHTML=e.string,n.appendChild(r),this.element.appendChild(n),n.addEventListener("mousedown",function(){this.selectingListItem=!0}.bind(this)),n.addEventListener("mouseup",function(){this.handleMouseUp.call(this,e)}.bind(this))};R.prototype.handleMouseUp=function(e){this.selectingListItem=!1,this.component.value(e.original),this.clear(),this.draw()};R.prototype.move=function(e){this.active=e,this.draw()};R.prototype.previous=function(){this.move(this.active===0?this.items.length-1:this.active-1)};R.prototype.next=function(){this.move(this.active===this.items.length-1?0:this.active+1)};R.prototype.drawError=function(e){var t=document.createElement("li");t.innerHTML=e,this.element.appendChild(t),this.show()};var et=R,tt=B,nt=ve.exports,rt=et,O=function(e,t,n){return n=n||{},this.options=tt({minLength:2,limit:5,filter:!0,hideOnBlur:!0},n),this.el=e,this.data=t||[],this.list=new rt(this),this.query="",this.selected=null,this.list.draw(),this.el.addEventListener("keyup",function(r){this.handleKeyUp(r.keyCode)}.bind(this),!1),this.el.addEventListener("keydown",function(r){this.handleKeyDown(r)}.bind(this)),this.el.addEventListener("focus",function(){this.handleFocus()}.bind(this)),this.el.addEventListener("blur",function(){this.handleBlur()}.bind(this)),this.el.addEventListener("paste",function(r){this.handlePaste(r)}.bind(this)),this.render=this.options.render?this.options.render.bind(this):this.render.bind(this),this.getItemValue=this.options.getItemValue?this.options.getItemValue.bind(this):this.getItemValue.bind(this),this};O.prototype.handleKeyUp=function(e){e===40||e===38||e===27||e===13||e===9||this.handleInputChange(this.el.value)};O.prototype.handleKeyDown=function(e){switch(e.keyCode){case 13:case 9:this.list.isEmpty()||(this.list.isVisible()&&e.preventDefault(),this.value(this.list.items[this.list.active].original),this.list.hide());break;case 27:this.list.isEmpty()||this.list.hide();break;case 38:this.list.previous();break;case 40:this.list.next();break}};O.prototype.handleBlur=function(){!this.list.selectingListItem&&this.options.hideOnBlur&&this.list.hide()};O.prototype.handlePaste=function(e){if(e.clipboardData)this.handleInputChange(e.clipboardData.getData("Text"));else{var t=this;setTimeout(function(){t.handleInputChange(e.target.value)},100)}};O.prototype.handleInputChange=function(e){if(this.query=this.normalize(e),this.list.clear(),this.query.length<this.options.minLength){this.list.draw();return}this.getCandidates(function(t){for(var n=0;n<t.length&&(this.list.add(t[n]),n!==this.options.limit-1);n++);this.list.draw()}.bind(this))};O.prototype.handleFocus=function(){this.list.isEmpty()||this.list.show(),this.list.selectingListItem=!1};O.prototype.update=function(e){this.data=e,this.handleKeyUp()};O.prototype.clear=function(){this.data=[],this.list.clear()};O.prototype.normalize=function(e){return e=e.toLowerCase(),e};O.prototype.match=function(e,t){return e.indexOf(t)>-1};O.prototype.value=function(e){if(this.selected=e,this.el.value=this.getItemValue(e),document.createEvent){var t=document.createEvent("HTMLEvents");t.initEvent("change",!0,!1),this.el.dispatchEvent(t)}else this.el.fireEvent("onchange")};O.prototype.getCandidates=function(e){var t={pre:"<strong>",post:"</strong>",extract:function(r){return this.getItemValue(r)}.bind(this)},n;this.options.filter?(n=nt.filter(this.query,this.data,t),n=n.map(function(r){return{original:r.original,string:this.render(r.original,r.string)}}.bind(this))):n=this.data.map(function(r){var i=this.render(r);return{original:r,string:i}}.bind(this)),e(n)};O.prototype.getItemValue=function(e){return e};O.prototype.render=function(e,t){if(t)return t;for(var n=e.original?this.getItemValue(e.original):this.getItemValue(e),r=this.normalize(n),i=r.lastIndexOf(this.query);i>-1;){var o=i+this.query.length;n=n.slice(0,i)+"<strong>"+n.slice(i,o)+"</strong>"+n.slice(o),i=r.slice(0,i).lastIndexOf(this.query)}return n};O.prototype.renderError=function(e){this.list.drawError(e)};var it=O,ge=it,ot=ge;typeof window!="undefined"&&(window.Suggestions=ge);var st="Expected a function",se=0/0,at="[object Symbol]",ut=/^\s+|\s+$/g,lt=/^[-+]0x[0-9a-f]+$/i,ct=/^0b[01]+$/i,ht=/^0o[0-7]+$/i,ft=parseInt,dt=typeof C=="object"&&C&&C.Object===Object&&C,pt=typeof self=="object"&&self&&self.Object===Object&&self,vt=dt||pt||Function("return this")(),gt=Object.prototype,mt=gt.toString,yt=Math.max,bt=Math.min,H=function(){return vt.Date.now()};function _t(e,t,n){var r,i,o,s,u,a,l=0,c=!1,f=!1,v=!0;if(typeof e!="function")throw new TypeError(st);t=ae(t)||0,X(n)&&(c=!!n.leading,f="maxWait"in n,o=f?yt(ae(n.maxWait)||0,t):o,v="trailing"in n?!!n.trailing:v);function g(w){var S=r,G=i;return r=i=void 0,l=w,s=e.apply(G,S),s}function h(w){return l=w,u=setTimeout(E,t),c?g(w):s}function b(w){var S=w-a,G=w-l,oe=t-S;return f?bt(oe,o-G):oe}function d(w){var S=w-a,G=w-l;return a===void 0||S>=t||S<0||f&&G>=o}function E(){var w=H();if(d(w))return L(w);u=setTimeout(E,b(w))}function L(w){return u=void 0,v&&r?g(w):(r=i=void 0,s)}function m(){u!==void 0&&clearTimeout(u),l=0,r=a=i=u=void 0}function A(){return u===void 0?s:L(H())}function x(){var w=H(),S=d(w);if(r=arguments,i=this,a=w,S){if(u===void 0)return h(a);if(f)return u=setTimeout(E,t),g(a)}return u===void 0&&(u=setTimeout(E,t)),s}return x.cancel=m,x.flush=A,x}function X(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function Et(e){return!!e&&typeof e=="object"}function xt(e){return typeof e=="symbol"||Et(e)&&mt.call(e)==at}function ae(e){if(typeof e=="number")return e;if(xt(e))return se;if(X(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=X(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=e.replace(ut,"");var n=ct.test(e);return n||ht.test(e)?ft(e.slice(2),n?2:8):lt.test(e)?se:+e}var wt=_t,ee={exports:{}},q=typeof Reflect=="object"?Reflect:null,ue=q&&typeof q.apply=="function"?q.apply:function(t,n,r){return Function.prototype.apply.call(t,n,r)},$;q&&typeof q.ownKeys=="function"?$=q.ownKeys:Object.getOwnPropertySymbols?$=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:$=function(t){return Object.getOwnPropertyNames(t)};function Lt(e){console&&console.warn&&console.warn(e)}var me=Number.isNaN||function(t){return t!==t};function y(){y.init.call(this)}ee.exports=y;ee.exports.once=At;y.EventEmitter=y;y.prototype._events=void 0;y.prototype._eventsCount=0;y.prototype._maxListeners=void 0;var le=10;function D(e){if(typeof e!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}Object.defineProperty(y,"defaultMaxListeners",{enumerable:!0,get:function(){return le},set:function(e){if(typeof e!="number"||e<0||me(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");le=e}});y.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};y.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||me(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function ye(e){return e._maxListeners===void 0?y.defaultMaxListeners:e._maxListeners}y.prototype.getMaxListeners=function(){return ye(this)};y.prototype.emit=function(t){for(var n=[],r=1;r<arguments.length;r++)n.push(arguments[r]);var i=t==="error",o=this._events;if(o!==void 0)i=i&&o.error===void 0;else if(!i)return!1;if(i){var s;if(n.length>0&&(s=n[0]),s instanceof Error)throw s;var u=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw u.context=s,u}var a=o[t];if(a===void 0)return!1;if(typeof a=="function")ue(a,this,n);else for(var l=a.length,c=we(a,l),r=0;r<l;++r)ue(c[r],this,n);return!0};function be(e,t,n,r){var i,o,s;if(D(n),o=e._events,o===void 0?(o=e._events=Object.create(null),e._eventsCount=0):(o.newListener!==void 0&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),s=o[t]),s===void 0)s=o[t]=n,++e._eventsCount;else if(typeof s=="function"?s=o[t]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),i=ye(e),i>0&&s.length>i&&!s.warned){s.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=s.length,Lt(u)}return e}y.prototype.addListener=function(t,n){return be(this,t,n,!1)};y.prototype.on=y.prototype.addListener;y.prototype.prependListener=function(t,n){return be(this,t,n,!0)};function Ot(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function _e(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=Ot.bind(r);return i.listener=n,r.wrapFn=i,i}y.prototype.once=function(t,n){return D(n),this.on(t,_e(this,t,n)),this};y.prototype.prependOnceListener=function(t,n){return D(n),this.prependListener(t,_e(this,t,n)),this};y.prototype.removeListener=function(t,n){var r,i,o,s,u;if(D(n),i=this._events,i===void 0)return this;if(r=i[t],r===void 0)return this;if(r===n||r.listener===n)--this._eventsCount===0?this._events=Object.create(null):(delete i[t],i.removeListener&&this.emit("removeListener",t,r.listener||n));else if(typeof r!="function"){for(o=-1,s=r.length-1;s>=0;s--)if(r[s]===n||r[s].listener===n){u=r[s].listener,o=s;break}if(o<0)return this;o===0?r.shift():Rt(r,o),r.length===1&&(i[t]=r[0]),i.removeListener!==void 0&&this.emit("removeListener",t,u||n)}return this};y.prototype.off=y.prototype.removeListener;y.prototype.removeAllListeners=function(t){var n,r,i;if(r=this._events,r===void 0)return this;if(r.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):r[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete r[t]),this;if(arguments.length===0){var o=Object.keys(r),s;for(i=0;i<o.length;++i)s=o[i],s!=="removeListener"&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(n=r[t],typeof n=="function")this.removeListener(t,n);else if(n!==void 0)for(i=n.length-1;i>=0;i--)this.removeListener(t,n[i]);return this};function Ee(e,t,n){var r=e._events;if(r===void 0)return[];var i=r[t];return i===void 0?[]:typeof i=="function"?n?[i.listener||i]:[i]:n?Ct(i):we(i,i.length)}y.prototype.listeners=function(t){return Ee(this,t,!0)};y.prototype.rawListeners=function(t){return Ee(this,t,!1)};y.listenerCount=function(e,t){return typeof e.listenerCount=="function"?e.listenerCount(t):xe.call(e,t)};y.prototype.listenerCount=xe;function xe(e){var t=this._events;if(t!==void 0){var n=t[e];if(typeof n=="function")return 1;if(n!==void 0)return n.length}return 0}y.prototype.eventNames=function(){return this._eventsCount>0?$(this._events):[]};function we(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function Rt(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function Ct(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}function At(e,t){return new Promise(function(n,r){function i(s){e.removeListener(t,o),r(s)}function o(){typeof e.removeListener=="function"&&e.removeListener("error",i),n([].slice.call(arguments))}Le(e,t,o,{once:!0}),t!=="error"&&St(e,i,{once:!0})})}function St(e,t,n){typeof e.on=="function"&&Le(e,"error",t,n)}function Le(e,t,n,r){if(typeof e.on=="function")r.once?e.once(t,n):e.on(t,n);else if(typeof e.addEventListener=="function")e.addEventListener(t,function i(o){r.once&&e.removeEventListener(t,i),n(o)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e)}var Tt={fr:{name:"France",bbox:[[-4.59235,41.380007],[9.560016,51.148506]]},us:{name:"United States",bbox:[[-171.791111,18.91619],[-66.96466,71.357764]]},ru:{name:"Russia",bbox:[[19.66064,41.151416],[190.10042,81.2504]]},ca:{name:"Canada",bbox:[[-140.99778,41.675105],[-52.648099,83.23324]]}};function Mt(e){var t=e.match(/\s*(.+)\s*=\s*"?([^"]+)"?/);return t?{key:t[1],value:t[2]}:null}function Pt(e){var t=e.match(/<?([^>]*)>(.*)/);if(!t)return null;var n=t[1],r=t[2].split(";"),i=null,o=r.reduce(function(s,u){var a=Mt(u);return a?a.key==="rel"?(i||(i=a.value),s):(s[a.key]=a.value,s):s},{});return i?{url:n,rel:i,params:o}:null}function It(e){return e?e.split(/,\s*</).reduce(function(t,n){var r=Pt(n);if(!r)return t;var i=r.rel.split(/\s+/);return i.forEach(function(o){t[o]||(t[o]={url:r.url,params:r.params})}),t},{}):{}}var kt=It,qt=kt;function te(e,t){this.request=e,this.headers=t.headers,this.rawBody=t.body,this.statusCode=t.statusCode;try{this.body=JSON.parse(t.body||"{}")}catch{this.body=t.body}this.links=qt(this.headers.link)}te.prototype.hasNextPage=function(){return!!this.links.next};te.prototype.nextPage=function(){return this.hasNextPage()?this.request._extend({path:this.links.next.url}):null};var jt=te,U={API_ORIGIN:"https://api.mapbox.com",EVENT_PROGRESS_DOWNLOAD:"downloadProgress",EVENT_PROGRESS_UPLOAD:"uploadProgress",EVENT_ERROR:"error",EVENT_RESPONSE:"response",ERROR_HTTP:"HttpError",ERROR_REQUEST_ABORTED:"RequestAbortedError"},ce=U;function Nt(e){var t=e.type||ce.ERROR_HTTP,n;if(e.body)try{n=JSON.parse(e.body)}catch{n=e.body}else n=null;var r=e.message||null;r||(typeof n=="string"?r=n:n&&typeof n.message=="string"?r=n.message:t===ce.ERROR_REQUEST_ABORTED&&(r="Request aborted")),this.message=r,this.type=t,this.statusCode=e.statusCode||null,this.request=e.request,this.body=n}var Bt=Nt;function Gt(e){var t=e.indexOf(":"),n=e.substring(0,t).trim().toLowerCase(),r=e.substring(t+1).trim();return{name:n,value:r}}function zt(e){var t={};return e&&e.trim().split(/[\r|\n]+/).forEach(function(n){var r=Gt(n);t[r.name]=r.value}),t}var $t=zt,Ft=jt,he=Bt,Q=U,Vt=$t,F={};function Dt(e){var t=F[e.id];!t||(t.abort(),delete F[e.id])}function Ut(e,t){return new Ft(e,{body:t.response,headers:Vt(t.getAllResponseHeaders()),statusCode:t.status})}function fe(e){var t=e.total,n=e.loaded,r=100*n/t;return{total:t,transferred:n,percent:r}}function Oe(e,t){return new Promise(function(n,r){t.onprogress=function(s){e.emitter.emit(Q.EVENT_PROGRESS_DOWNLOAD,fe(s))};var i=e.file;i&&(t.upload.onprogress=function(s){e.emitter.emit(Q.EVENT_PROGRESS_UPLOAD,fe(s))}),t.onerror=function(s){r(s)},t.onabort=function(){var s=new he({request:e,type:Q.ERROR_REQUEST_ABORTED});r(s)},t.onload=function(){if(delete F[e.id],t.status<200||t.status>=400){var s=new he({request:e,body:t.response,statusCode:t.status});r(s);return}n(t)};var o=e.body;typeof o=="string"?t.send(o):o?t.send(JSON.stringify(o)):i?t.send(i):t.send(),F[e.id]=t}).then(function(n){return Ut(e,n)})}function Re(e,t){var n=e.url(t),r=new window.XMLHttpRequest;return r.open(e.method,n),Object.keys(e.headers).forEach(function(i){r.setRequestHeader(i,e.headers[i])}),r}function Ht(e){return Promise.resolve().then(function(){var t=Re(e,e.client.accessToken);return Oe(e,t)})}var Qt={browserAbort:Dt,sendRequestXhr:Oe,browserSend:Ht,createRequestXhr:Re},Y={exports:{}};/*! http://mths.be/base64 v0.1.0 by @mathias | MIT license */(function(e,t){(function(n){var r=t,i=e&&e.exports==r&&e,o=typeof C=="object"&&C;(o.global===o||o.window===o)&&(n=o);var s=function(h){this.message=h};s.prototype=new Error,s.prototype.name="InvalidCharacterError";var u=function(h){throw new s(h)},a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",l=/[\t\n\f\r ]/g,c=function(h){h=String(h).replace(l,"");var b=h.length;b%4==0&&(h=h.replace(/==?$/,""),b=h.length),(b%4==1||/[^+a-zA-Z0-9/]/.test(h))&&u("Invalid character: the string to be decoded is not correctly encoded.");for(var d=0,E,L,m="",A=-1;++A<b;)L=a.indexOf(h.charAt(A)),E=d%4?E*64+L:L,d++%4&&(m+=String.fromCharCode(255&E>>(-2*d&6)));return m},f=function(h){h=String(h),/[^\0-\xFF]/.test(h)&&u("The string to be encoded contains characters outside of the Latin1 range.");for(var b=h.length%3,d="",E=-1,L,m,A,x,w=h.length-b;++E<w;)L=h.charCodeAt(E)<<16,m=h.charCodeAt(++E)<<8,A=h.charCodeAt(++E),x=L+m+A,d+=a.charAt(x>>18&63)+a.charAt(x>>12&63)+a.charAt(x>>6&63)+a.charAt(x&63);return b==2?(L=h.charCodeAt(E)<<8,m=h.charCodeAt(++E),x=L+m,d+=a.charAt(x>>10)+a.charAt(x>>4&63)+a.charAt(x<<2&63)+"="):b==1&&(x=h.charCodeAt(E),d+=a.charAt(x>>2)+a.charAt(x<<4&63)+"=="),d},v={encode:f,decode:c,version:"0.1.0"};if(r&&!r.nodeType)if(i)i.exports=v;else for(var g in v)v.hasOwnProperty(g)&&(r[g]=v[g]);else n.base64=v})(C)})(Y,Y.exports);var Kt=Y.exports,K={};function Wt(e){if(K[e])return K[e];var t=e.split("."),n=t[0],r=t[1];if(!r)throw new Error("Invalid token");var i=Zt(r),o={usage:n,user:i.u};return I(i,"a")&&(o.authorization=i.a),I(i,"exp")&&(o.expires=i.exp*1e3),I(i,"iat")&&(o.created=i.iat*1e3),I(i,"scopes")&&(o.scopes=i.scopes),I(i,"client")&&(o.client=i.client),I(i,"ll")&&(o.lastLogin=i.ll),I(i,"iu")&&(o.impersonator=i.iu),K[e]=o,o}function Zt(e){try{return JSON.parse(Kt.decode(e))}catch{throw new Error("Invalid token")}}function I(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var Ce=Wt,Ae={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function i(a,l,c){this.fn=a,this.context=l,this.once=c||!1}function o(a,l,c,f,v){if(typeof c!="function")throw new TypeError("The listener must be a function");var g=new i(c,f||a,v),h=n?n+l:l;return a._events[h]?a._events[h].fn?a._events[h]=[a._events[h],g]:a._events[h].push(g):(a._events[h]=g,a._eventsCount++),a}function s(a,l){--a._eventsCount===0?a._events=new r:delete a._events[l]}function u(){this._events=new r,this._eventsCount=0}u.prototype.eventNames=function(){var l=[],c,f;if(this._eventsCount===0)return l;for(f in c=this._events)t.call(c,f)&&l.push(n?f.slice(1):f);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(c)):l},u.prototype.listeners=function(l){var c=n?n+l:l,f=this._events[c];if(!f)return[];if(f.fn)return[f.fn];for(var v=0,g=f.length,h=new Array(g);v<g;v++)h[v]=f[v].fn;return h},u.prototype.listenerCount=function(l){var c=n?n+l:l,f=this._events[c];return f?f.fn?1:f.length:0},u.prototype.emit=function(l,c,f,v,g,h){var b=n?n+l:l;if(!this._events[b])return!1;var d=this._events[b],E=arguments.length,L,m;if(d.fn){switch(d.once&&this.removeListener(l,d.fn,void 0,!0),E){case 1:return d.fn.call(d.context),!0;case 2:return d.fn.call(d.context,c),!0;case 3:return d.fn.call(d.context,c,f),!0;case 4:return d.fn.call(d.context,c,f,v),!0;case 5:return d.fn.call(d.context,c,f,v,g),!0;case 6:return d.fn.call(d.context,c,f,v,g,h),!0}for(m=1,L=new Array(E-1);m<E;m++)L[m-1]=arguments[m];d.fn.apply(d.context,L)}else{var A=d.length,x;for(m=0;m<A;m++)switch(d[m].once&&this.removeListener(l,d[m].fn,void 0,!0),E){case 1:d[m].fn.call(d[m].context);break;case 2:d[m].fn.call(d[m].context,c);break;case 3:d[m].fn.call(d[m].context,c,f);break;case 4:d[m].fn.call(d[m].context,c,f,v);break;default:if(!L)for(x=1,L=new Array(E-1);x<E;x++)L[x-1]=arguments[x];d[m].fn.apply(d[m].context,L)}}return!0},u.prototype.on=function(l,c,f){return o(this,l,c,f,!1)},u.prototype.once=function(l,c,f){return o(this,l,c,f,!0)},u.prototype.removeListener=function(l,c,f,v){var g=n?n+l:l;if(!this._events[g])return this;if(!c)return s(this,g),this;var h=this._events[g];if(h.fn)h.fn===c&&(!v||h.once)&&(!f||h.context===f)&&s(this,g);else{for(var b=0,d=[],E=h.length;b<E;b++)(h[b].fn!==c||v&&!h[b].once||f&&h[b].context!==f)&&d.push(h[b]);d.length?this._events[g]=d.length===1?d[0]:d:s(this,g)}return this},u.prototype.removeAllListeners=function(l){var c;return l?(c=n?n+l:l,this._events[c]&&s(this,c)):(this._events=new r,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=n,u.EventEmitter=u,e.exports=u})(Ae);function Jt(e){return e.map(encodeURIComponent).join(",")}function Se(e){return Array.isArray(e)?Jt(e):encodeURIComponent(String(e))}function Te(e,t,n){if(n===!1||n===null)return e;var r=/\?/.test(e)?"&":"?",i=encodeURIComponent(t);return n!==void 0&&n!==""&&n!==!0&&(i+="="+Se(n)),""+e+r+i}function Xt(e,t){if(!t)return e;var n=e;return Object.keys(t).forEach(function(r){var i=t[r];i!==void 0&&(Array.isArray(i)&&(i=i.filter(function(o){return o!=null}).join(",")),n=Te(n,r,i))}),n}function Yt(e,t){if(!t||e.slice(0,4)==="http")return e;var n=e[0]==="/"?"":"/";return""+t.replace(/\/$/,"")+n+e}function en(e,t){return t?e.replace(/\/:([a-zA-Z0-9]+)/g,function(n,r){var i=t[r];if(i===void 0)throw new Error("Unspecified route parameter "+r);var o=Se(i);return"/"+o}):e}var tn={appendQueryObject:Xt,appendQueryParam:Te,prependOrigin:Yt,interpolateRouteParams:en},nn=Ce,ne=B,rn=Ae.exports,z=tn,de=U,on=1;function M(e,t){if(!e)throw new Error("MapiRequest requires a client");if(!t||!t.path||!t.method)throw new Error("MapiRequest requires an options object with path and method properties");var n={};t.body&&(n["content-type"]="application/json");var r=ne(n,t.headers),i=Object.keys(r).reduce(function(o,s){return o[s.toLowerCase()]=r[s],o},{});this.id=on++,this._options=t,this.emitter=new rn,this.client=e,this.response=null,this.error=null,this.sent=!1,this.aborted=!1,this.path=t.path,this.method=t.method,this.origin=t.origin||e.origin,this.query=t.query||{},this.params=t.params||{},this.body=t.body||null,this.file=t.file||null,this.encoding=t.encoding||"utf8",this.sendFileAs=t.sendFileAs||null,this.headers=i}M.prototype.url=function(t){var n=z.prependOrigin(this.path,this.origin);n=z.appendQueryObject(n,this.query);var r=this.params,i=t==null?this.client.accessToken:t;if(i){n=z.appendQueryParam(n,"access_token",i);var o=nn(i).user;r=ne({ownerId:o},r)}return n=z.interpolateRouteParams(n,r),n};M.prototype.send=function(){var t=this;if(t.sent)throw new Error("This request has already been sent. Check the response and error properties. Create a new request with clone().");return t.sent=!0,t.client.sendRequest(t).then(function(n){return t.response=n,t.emitter.emit(de.EVENT_RESPONSE,n),n},function(n){throw t.error=n,t.emitter.emit(de.EVENT_ERROR,n),n})};M.prototype.abort=function(){this._nextPageRequest&&(this._nextPageRequest.abort(),delete this._nextPageRequest),!(this.response||this.error||this.aborted)&&(this.aborted=!0,this.client.abortRequest(this))};M.prototype.eachPage=function(t){var n=this;function r(s){function u(){delete n._nextPageRequest;var a=s.nextPage();a&&(n._nextPageRequest=a,o(a))}t(null,s,u)}function i(s){t(s,null,function(){})}function o(s){s.send().then(r,i)}o(this)};M.prototype.clone=function(){return this._extend()};M.prototype._extend=function(t){var n=ne(this._options,t);return new M(this.client,n)};var sn=M,an=Ce,un=sn,ln=U;function Me(e){if(!e||!e.accessToken)throw new Error("Cannot create a client without an access token");an(e.accessToken),this.accessToken=e.accessToken,this.origin=e.origin||ln.API_ORIGIN}Me.prototype.createRequest=function(t){return new un(this,t)};var Pe=Me,Ie=Qt,ke=Pe;function N(e){ke.call(this,e)}N.prototype=Object.create(ke.prototype);N.prototype.constructor=N;N.prototype.sendRequest=Ie.browserSend;N.prototype.abortRequest=Ie.browserAbort;function cn(e){return new N(e)}var qe=cn,hn=qe,fn=hn,dn=Object.prototype.toString,pn=function(e){var t;return dn.call(e)==="[object Object]"&&(t=Object.getPrototypeOf(e),t===null||t===Object.getPrototypeOf({}))},vn=pn,gn=B,je="value",W=`
  `,_={};_.assert=function(e,t){return t=t||{},function(n){var r=P(e,n);if(!!r){var i=re(r,t);throw t.apiName&&(i=t.apiName+": "+i),new Error(i)}}};_.shape=function(t){var n=_n(t);return function(i){var o=P(_.plainObject,i);if(o)return o;for(var s,u,a=[],l=0;l<n.length;l++)s=n[l].key,u=n[l].value,o=P(u,i[s]),o&&a.push([s].concat(o));return a.length<2?a[0]:function(c){a=a.map(function(g){var h=g[0],b=re(g,c).split(`
`).join(W);return"- "+h+": "+b});var f=c.path.join("."),v=f===je?"":" of "+f;return"The following properties"+v+" have invalid values:"+W+a.join(W)}}};_.strictShape=function(t){var n=_.shape(t);return function(i){var o=n(i);if(o)return o;var s=Object.keys(i).reduce(function(u,a){return t[a]===void 0&&u.push(a),u},[]);if(s.length!==0)return function(){return"The following keys are invalid: "+s.join(", ")}}};_.arrayOf=function(t){return Ne(t)};_.tuple=function(){var t=Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments);return Ne(t)};function Ne(e){var t=Array.isArray(e),n=function(r){return t?e[r]:e};return function(i){var o=P(_.plainArray,i);if(o)return o;if(t&&i.length!==e.length)return"an array with "+e.length+" items";for(var s=0;s<i.length;s++)if(o=P(n(s),i[s]),o)return[s].concat(o)}}_.required=function(t){function n(r){return r==null?function(i){return Be(i,Ge(i.path)?"cannot be undefined/null.":"is required.")}:t.apply(this,arguments)}return n.__required=!0,n};_.oneOfType=function(){var t=Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments);return function(r){var i=t.map(function(o){return P(o,r)}).filter(Boolean);if(i.length===t.length)return i.every(function(o){return o.length===1&&typeof o[0]=="string"})?mn(i.map(function(o){return o[0]})):i.reduce(function(o,s){return s.length>o.length?s:o})}};_.equal=function(t){return function(r){if(r!==t)return JSON.stringify(t)}};_.oneOf=function(){var t=Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments),n=t.map(function(r){return _.equal(r)});return _.oneOfType.apply(this,n)};_.range=function(t){var n=t[0],r=t[1];return function(o){var s=P(_.number,o);if(s||o<n||o>r)return"number between "+n+" & "+r+" (inclusive)"}};_.any=function(){};_.boolean=function(t){if(typeof t!="boolean")return"boolean"};_.number=function(t){if(typeof t!="number")return"number"};_.plainArray=function(t){if(!Array.isArray(t))return"array"};_.plainObject=function(t){if(!vn(t))return"object"};_.string=function(t){if(typeof t!="string")return"string"};_.func=function(t){if(typeof t!="function")return"function"};function P(e,t){if(!(t==null&&!e.hasOwnProperty("__required"))){var n=e(t);if(n)return Array.isArray(n)?n:[n]}}function re(e,t){var n=e.length,r=e[n-1],i=e.slice(0,n-1);return i.length===0&&(i=[je]),t=gn(t,{path:i}),typeof r=="function"?r(t):Be(t,yn(r))}function mn(e){return e.length<2?e[0]:e.length===2?e.join(" or "):e.slice(0,-1).join(", ")+", or "+e.slice(-1)}function yn(e){return"must be "+bn(e)+"."}function bn(e){return/^an? /.test(e)?e:/^[aeiou]/i.test(e)?"an "+e:/^[a-z]/i.test(e)?"a "+e:e}function Be(e,t){var n=Ge(e.path),r=e.path.join(".")+" "+t,i=n?"Item at position ":"";return i+r}function Ge(e){return typeof e[e.length-1]=="number"||typeof e[0]=="number"}function _n(e){return Object.keys(e||{}).map(function(t){return{key:t,value:e[t]}})}_.validate=P;_.processMessage=re;var En=_,xn=B,j=En;function wn(e){if(typeof window!="undefined")return e instanceof C.Blob||e instanceof C.ArrayBuffer?void 0:"Blob or ArrayBuffer";if(!(typeof e=="string"||e.pipe!==void 0))return"Filename or Readable stream"}function Ln(e,t){return j.assert(j.strictShape(e),t)}function On(e){var t="date";if(typeof e=="boolean")return t;try{var n=new Date(e);if(n.getTime&&isNaN(n.getTime()))return t}catch{return t}}function Rn(e){return j.tuple(j.number,j.number)(e)}var Cn=xn(j,{file:wn,date:On,coordinates:Rn,assertShape:Ln});function An(e,t){var n=function(r,i){return t.indexOf(r)!==-1&&i!==void 0};return typeof t=="function"&&(n=t),Object.keys(e).filter(function(r){return n(r,e[r])}).reduce(function(r,i){return r[i]=e[i],r},{})}var Sn=An;function Tn(e,t){return Object.keys(e).reduce(function(n,r){return n[r]=t(r,e[r]),n},{})}var Mn=Tn,Pn=Mn;function In(e){return Pn(e,function(t,n){return typeof n=="boolean"?JSON.stringify(n):n})}var kn=In,qn=Pe,jn=qe;function Nn(e){return function(t){var n;qn.prototype.isPrototypeOf(t)?n=t:n=jn(t);var r=Object.create(e);return r.client=n,r}}var Bn=Nn,ze=B,p=Cn,V=Sn,$e=kn,Gn=Bn,ie={},Fe=["country","region","postcode","district","place","locality","neighborhood","address","poi","poi.landmark"];ie.forwardGeocode=function(e){p.assertShape({query:p.required(p.string),mode:p.oneOf("mapbox.places","mapbox.places-permanent"),countries:p.arrayOf(p.string),proximity:p.oneOf(p.coordinates,"ip"),types:p.arrayOf(p.oneOf(Fe)),autocomplete:p.boolean,bbox:p.arrayOf(p.number),limit:p.number,language:p.arrayOf(p.string),routing:p.boolean,fuzzyMatch:p.boolean,worldview:p.string})(e),e.mode=e.mode||"mapbox.places";var t=$e(ze({country:e.countries},V(e,["proximity","types","autocomplete","bbox","limit","language","routing","fuzzyMatch","worldview"])));return this.client.createRequest({method:"GET",path:"/geocoding/v5/:mode/:query.json",params:V(e,["mode","query"]),query:t})};ie.reverseGeocode=function(e){p.assertShape({query:p.required(p.coordinates),mode:p.oneOf("mapbox.places","mapbox.places-permanent"),countries:p.arrayOf(p.string),types:p.arrayOf(p.oneOf(Fe)),bbox:p.arrayOf(p.number),limit:p.number,language:p.arrayOf(p.string),reverseMode:p.oneOf("distance","score"),routing:p.boolean,worldview:p.string})(e),e.mode=e.mode||"mapbox.places";var t=$e(ze({country:e.countries},V(e,["country","types","bbox","limit","language","reverseMode","routing","worldview"])));return this.client.createRequest({method:"GET",path:"/geocoding/v5/:mode/:query.json",params:V(e,["mode","query"]),query:t})};var zn=Gn(ie);let $n="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",Ve=e=>crypto.getRandomValues(new Uint8Array(e)),De=(e,t,n)=>{let r=(2<<Math.log(e.length-1)/Math.LN2)-1,i=-~(1.6*r*t/e.length);return(o=t)=>{let s="";for(;;){let u=n(i),a=i;for(;a--;)if(s+=e[u[a]&r]||"",s.length===o)return s}}},Fn=(e,t=21)=>De(e,t,Ve),Vn=(e=21)=>{let t="",n=crypto.getRandomValues(new Uint8Array(e));for(;e--;){let r=n[e]&63;r<36?t+=r.toString(36):r<62?t+=(r-26).toString(36).toUpperCase():r<63?t+="_":t+="-"}return t};var Dn=Object.freeze(Object.defineProperty({__proto__:null,nanoid:Vn,customAlphabet:Fn,customRandom:De,urlAlphabet:$n,random:Ve},Symbol.toStringTag,{value:"Module"})),Un=Ze(Dn),Hn=Un.nanoid;function Ue(e){this.origin=e.origin||"https://api.mapbox.com",this.endpoint="events/v2",this.access_token=e.accessToken,this.version="0.2.0",this.sessionID=this.generateSessionID(),this.userAgent=this.getUserAgent(),this.options=e,this.send=this.send.bind(this),this.countries=e.countries?e.countries.split(","):null,this.types=e.types?e.types.split(","):null,this.bbox=e.bbox?e.bbox:null,this.language=e.language?e.language.split(","):null,this.limit=e.limit?+e.limit:null,this.locale=navigator.language||null,this.enableEventLogging=this.shouldEnableLogging(e),this.eventQueue=new Array,this.flushInterval=e.flushInterval||1e3,this.maxQueueSize=e.maxQueueSize||100,this.timer=this.flushInterval?setTimeout(this.flush.bind(this),this.flushInterval):null,this.lastSentInput="",this.lastSentIndex=0}Ue.prototype={select:function(e,t){var n=this.getSelectedIndex(e,t),r=this.getEventPayload("search.select",t);if(r.resultIndex=n,r.resultPlaceName=e.place_name,r.resultId=e.id,!(n===this.lastSentIndex&&r.queryString===this.lastSentInput||n==-1)&&(this.lastSentIndex=n,this.lastSentInput=r.queryString,!!r.queryString))return this.push(r)},start:function(e){var t=this.getEventPayload("search.start",e);if(!!t.queryString)return this.push(t)},keyevent:function(e,t){if(!!e.key&&!(e.metaKey||[9,27,37,39,13,38,40].indexOf(e.keyCode)!==-1)){var n=this.getEventPayload("search.keystroke",t);if(n.lastAction=e.key,!!n.queryString)return this.push(n)}},send:function(e,t){if(!this.enableEventLogging)return t?t():void 0;var n=this.getRequestOptions(e);this.request(n,function(r){if(r)return this.handleError(r,t);if(t)return t()}.bind(this))},getRequestOptions:function(e){Array.isArray(e)||(e=[e]);var t={method:"POST",host:this.origin,path:this.endpoint+"?access_token="+this.access_token,headers:{"Content-Type":"application/json"},body:JSON.stringify(e)};return t},getEventPayload:function(e,t){var n;t.options.proximity?n=[t.options.proximity.longitude,t.options.proximity.latitude]:n=null;var r=t._map?t._map.getZoom():void 0,i={event:e,created:+new Date,sessionIdentifier:this.sessionID,country:this.countries,userAgent:this.userAgent,language:this.language,bbox:this.bbox,types:this.types,endpoint:"mapbox.places",autocomplete:t.options.autocomplete,fuzzyMatch:t.options.fuzzyMatch,proximity:n,limit:t.options.limit,routing:t.options.routing,worldview:t.options.worldview,mapZoom:r,keyboardLocale:this.locale};return e==="search.select"?i.queryString=t.inputString:e!="search.select"&&t._inputEl?i.queryString=t._inputEl.value:i.queryString=t.inputString,i},request:function(e,t){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(this.readyState==4)return this.status==204?t(null):t(this.statusText)},n.open(e.method,e.host+"/"+e.path,!0);for(var r in e.headers){var i=e.headers[r];n.setRequestHeader(r,i)}n.send(e.body)},handleError:function(e,t){if(t)return t(e)},generateSessionID:function(){return Hn()},getUserAgent:function(){return"mapbox-gl-geocoder."+this.version+"."+navigator.userAgent},getSelectedIndex:function(e,t){if(!!t._typeahead){var n=t._typeahead.data,r=e.id,i=n.map(function(s){return s.id}),o=i.indexOf(r);return o}},shouldEnableLogging:function(e){return!(e.enableEventLogging===!1||e.origin&&e.origin.indexOf("api.mapbox.com")==-1||e.localGeocoder||e.filter)},flush:function(){this.eventQueue.length>0&&(this.send(this.eventQueue),this.eventQueue=new Array),this.timer&&clearTimeout(this.timer),this.flushInterval&&(this.timer=setTimeout(this.flush.bind(this),this.flushInterval))},push:function(e,t){this.eventQueue.push(e),(this.eventQueue.length>=this.maxQueueSize||t)&&this.flush()},remove:function(){this.flush()}};var Qn=Ue,Kn={de:"Suche",it:"Ricerca",en:"Search",nl:"Zoeken",fr:"Chercher",ca:"Cerca",he:"\u05DC\u05D7\u05E4\u05E9",ja:"\u30B5\u30FC\u30C1",lv:"Mekl\u0113t",pt:"Procurar",sr:"\u041F\u0440\u0435\u0442\u0440\u0430\u0433\u0430",zh:"\u641C\u7D22",cs:"Vyhled\xE1v\xE1n\xED",hu:"Keres\xE9s",ka:"\u10EB\u10D8\u10D4\u10D1\u10D0",nb:"S\xF8ke",sk:"Vyh\u013Ead\xE1vanie",th:"\u0E04\u0E49\u0E19\u0E2B\u0E32",fi:"Hae",is:"Leita",ko:"\uC218\uC0C9",pl:"Szukaj",sl:"Iskanje",fa:"\u062C\u0633\u062A\u062C\u0648",ru:"\u041F\u043E\u0438\u0441\u043A"},Wn={placeholder:Kn},He={exports:{}};(function(e){(function(t,n,r){e.exports?e.exports=r():t[n]=r()})(C,"subtag",function(){var t="",n=/^([a-zA-Z]{2,3})(?:[_-]+([a-zA-Z]{3})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{4})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{2}|[0-9]{3})(?=$|[_-]+))?/;function r(a){return a.match(n)||[]}function i(a){return r(a).filter(function(l,c){return l&&c})}function o(a){return a=r(a),{language:a[1]||t,extlang:a[2]||t,script:a[3]||t,region:a[4]||t}}function s(a,l,c){Object.defineProperty(a,l,{value:c,enumerable:!0})}function u(a,l,c){function f(v){return r(v)[a]||t}s(f,"pattern",l),s(o,c,f)}return u(1,/^[a-zA-Z]{2,3}$/,"language"),u(2,/^[a-zA-Z]{3}$/,"extlang"),u(3,/^[a-zA-Z]{4}$/,"script"),u(4,/^[a-zA-Z]{2}$|^[0-9]{3}$/,"region"),s(o,"split",i),o})})(He);function Qe(){}Qe.prototype={isSupport:function(){return Boolean(window.navigator.geolocation)},getCurrentPosition:function(){const e={enableHighAccuracy:!0};return new Promise(function(t,n){window.navigator.geolocation.getCurrentPosition(t,n,e)})}};var Zn=Qe;function Jn(e,t){const n=Ke(e),r=["address","street","place","country"];var i;if(typeof t=="function")return t(n);const o=r.indexOf(t);return o===-1?i=r:i=r.slice(o),i.reduce(function(s,u){return n[u]?(s!==""&&(s=s+", "),s+n[u]):s},"")}function Ke(e){const t=e.address||"",n=e.text||"",r=e.place_name||"",o={address:r.split(",")[0],houseNumber:t,street:n,placeName:r};return e.context.forEach(function(s){const u=s.id.split(".")[0];o[u]=s.text}),o}var Xn={transformFeatureToGeolocationText:Jn,getAddressInfo:Ke},Yn=ot,er=wt,k=B,tr=ee.exports.EventEmitter,pe=Tt,Z=fn,J=zn,nr=Qn,rr=Wn,ir=He.exports,or=Zn,sr=Xn;const T={FORWARD:0,LOCAL:1,REVERSE:2};function ar(){var e=document.createElement("div");return e.className="mapboxgl-ctrl-geocoder--powered-by",e.innerHTML='<a href="https://www.mapbox.com/search-service" target="_blank">Powered by Mapbox</a>',e}function We(e){this._eventEmitter=new tr,this.options=k({},this.options,e),this.inputString="",this.fresh=!0,this.lastSelected=null,this.geolocation=new or}We.prototype={options:{zoom:16,flyTo:!0,trackProximity:!0,minLength:2,reverseGeocode:!1,flipCoordinates:!1,limit:5,origin:"https://api.mapbox.com",enableEventLogging:!0,marker:!0,mapboxgl:null,collapsed:!1,clearAndBlurOnEsc:!1,clearOnBlur:!1,enableGeolocation:!1,addressAccuracy:"street",getItemValue:function(e){return e.place_name},render:function(e){var t=e.place_name.split(",");return'<div class="mapboxgl-ctrl-geocoder--suggestion"><div class="mapboxgl-ctrl-geocoder--suggestion-title">'+t[0]+'</div><div class="mapboxgl-ctrl-geocoder--suggestion-address">'+t.splice(1,t.length).join(",")+"</div></div>"}},addTo:function(e){function t(n,r){if(!document.body.contains(r))throw new Error("Element provided to #addTo() exists, but is not in the DOM");const i=n.onAdd();r.appendChild(i)}if(e._controlContainer)e.addControl(this);else if(e instanceof HTMLElement)t(this,e);else if(typeof e=="string"){const n=document.querySelectorAll(e);if(n.length===0)throw new Error("Element ",e,"not found.");if(n.length>1)throw new Error("Geocoder can only be added to a single html element");t(this,n[0])}else throw new Error("Error: addTo must be a mapbox-gl-js map, an html element, or a CSS selector query for a single html element")},onAdd:function(e){if(e&&typeof e!="string"&&(this._map=e),this.setLanguage(),this.options.localGeocoderOnly||(this.geocoderService=J(Z({accessToken:this.options.accessToken,origin:this.options.origin}))),this.options.localGeocoderOnly&&!this.options.localGeocoder)throw new Error("A localGeocoder function must be specified to use localGeocoderOnly mode");this.eventManager=new nr(this.options),this._onChange=this._onChange.bind(this),this._onKeyDown=this._onKeyDown.bind(this),this._onPaste=this._onPaste.bind(this),this._onBlur=this._onBlur.bind(this),this._showButton=this._showButton.bind(this),this._hideButton=this._hideButton.bind(this),this._onQueryResult=this._onQueryResult.bind(this),this.clear=this.clear.bind(this),this._updateProximity=this._updateProximity.bind(this),this._collapse=this._collapse.bind(this),this._unCollapse=this._unCollapse.bind(this),this._clear=this._clear.bind(this),this._clearOnBlur=this._clearOnBlur.bind(this),this._geolocateUser=this._geolocateUser.bind(this);var t=this.container=document.createElement("div");t.className="mapboxgl-ctrl-geocoder mapboxgl-ctrl";var n=this.createIcon("search",'<path d="M7.4 2.5c-2.7 0-4.9 2.2-4.9 4.9s2.2 4.9 4.9 4.9c1 0 1.8-.2 2.5-.8l3.7 3.7c.2.2.4.3.8.3.7 0 1.1-.4 1.1-1.1 0-.3-.1-.5-.3-.8L11.4 10c.4-.8.8-1.6.8-2.5.1-2.8-2.1-5-4.8-5zm0 1.6c1.8 0 3.2 1.4 3.2 3.2s-1.4 3.2-3.2 3.2-3.3-1.3-3.3-3.1 1.4-3.3 3.3-3.3z"/>');this._inputEl=document.createElement("input"),this._inputEl.type="text",this._inputEl.className="mapboxgl-ctrl-geocoder--input",this.setPlaceholder(),this.options.collapsed&&(this._collapse(),this.container.addEventListener("mouseenter",this._unCollapse),this.container.addEventListener("mouseleave",this._collapse),this._inputEl.addEventListener("focus",this._unCollapse)),(this.options.collapsed||this.options.clearOnBlur)&&this._inputEl.addEventListener("blur",this._onBlur),this._inputEl.addEventListener("keydown",er(this._onKeyDown,200)),this._inputEl.addEventListener("paste",this._onPaste),this._inputEl.addEventListener("change",this._onChange),this.container.addEventListener("mouseenter",this._showButton),this.container.addEventListener("mouseleave",this._hideButton),this._inputEl.addEventListener("keyup",function(u){this.eventManager.keyevent(u,this)}.bind(this));var r=document.createElement("div");r.classList.add("mapboxgl-ctrl-geocoder--pin-right"),this._clearEl=document.createElement("button"),this._clearEl.setAttribute("aria-label","Clear"),this._clearEl.addEventListener("click",this.clear),this._clearEl.className="mapboxgl-ctrl-geocoder--button";var i=this.createIcon("close",'<path d="M3.8 2.5c-.6 0-1.3.7-1.3 1.3 0 .3.2.7.5.8L7.2 9 3 13.2c-.3.3-.5.7-.5 1 0 .6.7 1.3 1.3 1.3.3 0 .7-.2 1-.5L9 10.8l4.2 4.2c.2.3.7.3 1 .3.6 0 1.3-.7 1.3-1.3 0-.3-.2-.7-.3-1l-4.4-4L15 4.6c.3-.2.5-.5.5-.8 0-.7-.7-1.3-1.3-1.3-.3 0-.7.2-1 .3L9 7.1 4.8 2.8c-.3-.1-.7-.3-1-.3z"/>');this._clearEl.appendChild(i),this._loadingEl=this.createIcon("loading",'<path fill="#333" d="M4.4 4.4l.8.8c2.1-2.1 5.5-2.1 7.6 0l.8-.8c-2.5-2.5-6.7-2.5-9.2 0z"/><path opacity=".1" d="M12.8 12.9c-2.1 2.1-5.5 2.1-7.6 0-2.1-2.1-2.1-5.5 0-7.7l-.8-.8c-2.5 2.5-2.5 6.7 0 9.2s6.6 2.5 9.2 0 2.5-6.6 0-9.2l-.8.8c2.2 2.1 2.2 5.6 0 7.7z"/>'),r.appendChild(this._clearEl),r.appendChild(this._loadingEl),t.appendChild(n),t.appendChild(this._inputEl),t.appendChild(r),this.options.enableGeolocation&&this.geolocation.isSupport()&&(this._geolocateEl=this.createIcon("geolocate",'<path d="M12.999 3.677L2.042 8.269c-.962.403-.747 1.823.29 1.912l5.032.431.431 5.033c.089 1.037 1.509 1.252 1.912.29l4.592-10.957c.345-.822-.477-1.644-1.299-1.299z" fill="#4264fb"/>'),r.appendChild(this._geolocateEl),this._geolocateEl.addEventListener("click",this._geolocateUser),this._showGeolocateButton());var o=this._typeahead=new Yn(this._inputEl,[],{filter:!1,minLength:this.options.minLength,limit:this.options.limit});this.setRenderFunction(this.options.render),o.getItemValue=this.options.getItemValue;var s=o.list.draw;return o.list.draw=function(){s.call(this);var u=ar();u.addEventListener("mousedown",function(){this.selectingListItem=!0}.bind(this)),u.addEventListener("mouseup",function(){this.selectingListItem=!1}.bind(this)),this.element.appendChild(u)},this.mapMarker=null,this._handleMarker=this._handleMarker.bind(this),this._map&&(this.options.trackProximity&&(this._updateProximity(),this._map.on("moveend",this._updateProximity)),this._mapboxgl=this.options.mapboxgl,!this._mapboxgl&&this.options.marker&&(console.error("No mapboxgl detected in options. Map markers are disabled. Please set options.mapboxgl."),this.options.marker=!1)),t},_geolocateUser:function(){this._hideGeolocateButton(),this._showLoadingIcon(),this.geolocation.getCurrentPosition().then(function(e){this._hideLoadingIcon();const t={geometry:{type:"Point",coordinates:[e.coords.longitude,e.coords.latitude]}};this._handleMarker(t),this._fly(t),this._typeahead.clear(),this._typeahead.selected=!0,this.lastSelected=JSON.stringify(t),this._showClearButton(),this.fresh=!1;const n={limit:1,language:[this.options.language],query:t.geometry.coordinates,types:["address"]};if(this.options.localGeocoderOnly){const r=t.geometry.coordinates[0]+","+t.geometry.coordinates[1];this._setInputValue(r),this._eventEmitter.emit("result",{result:t})}else this.geocoderService.reverseGeocode(n).send().then(function(r){const i=r.body.features[0];if(i){const o=sr.transformFeatureToGeolocationText(i,this.options.addressAccuracy);this._setInputValue(o),i.user_coordinates=t.geometry.coordinates,this._eventEmitter.emit("result",{result:i})}else this._eventEmitter.emit("result",{result:{user_coordinates:t.geometry.coordinates}})}.bind(this))}.bind(this)).catch(function(e){e.code===1?this._renderUserDeniedGeolocationError():this._renderLocationError(),this._hideLoadingIcon(),this._showGeolocateButton()}.bind(this))},createIcon:function(e,t){var n=document.createElementNS("http://www.w3.org/2000/svg","svg");return n.setAttribute("class","mapboxgl-ctrl-geocoder--icon mapboxgl-ctrl-geocoder--icon-"+e),n.setAttribute("viewBox","0 0 18 18"),n.setAttribute("xml:space","preserve"),n.setAttribute("width",18),n.setAttribute("height",18),n.innerHTML=t,n},onRemove:function(){return this.container.parentNode.removeChild(this.container),this.options.trackProximity&&this._map&&this._map.off("moveend",this._updateProximity),this._removeMarker(),this._map=null,this},_setInputValue:function(e){this._inputEl.value=e,setTimeout(function(){this._inputEl.focus(),this._inputEl.scrollLeft=0,this._inputEl.setSelectionRange(0,0)}.bind(this),1)},_onPaste:function(e){var t=(e.clipboardData||window.clipboardData).getData("text");t.length>=this.options.minLength&&this._geocode(t)},_onKeyDown:function(e){var t=27,n=9;if(e.keyCode===t&&this.options.clearAndBlurOnEsc)return this._clear(e),this._inputEl.blur();var r=e.target&&e.target.shadowRoot?e.target.shadowRoot.activeElement:e.target,i=r?r.value:"";if(!i)return this.fresh=!0,e.keyCode!==n&&this.clear(e),this._showGeolocateButton(),this._hideClearButton();this._hideGeolocateButton(),!(e.metaKey||[n,t,37,39,13,38,40].indexOf(e.keyCode)!==-1)&&r.value.length>=this.options.minLength&&this._geocode(r.value)},_showButton:function(){this._typeahead.selected&&this._showClearButton()},_hideButton:function(){this._typeahead.selected&&this._hideClearButton()},_showClearButton:function(){this._clearEl.style.display="block"},_hideClearButton:function(){this._clearEl.style.display="none"},_showGeolocateButton:function(){this._geolocateEl&&this.geolocation.isSupport()&&(this._geolocateEl.style.display="block")},_hideGeolocateButton:function(){this._geolocateEl&&(this._geolocateEl.style.display="none")},_showLoadingIcon:function(){this._loadingEl.style.display="block"},_hideLoadingIcon:function(){this._loadingEl.style.display="none"},_onBlur:function(e){this.options.clearOnBlur&&this._clearOnBlur(e),this.options.collapsed&&this._collapse()},_onChange:function(){var e=this._typeahead.selected;e&&JSON.stringify(e)!==this.lastSelected&&(this._hideClearButton(),this.options.flyTo&&this._fly(e),this.options.marker&&this._mapboxgl&&this._handleMarker(e),this._inputEl.focus(),this._inputEl.scrollLeft=0,this._inputEl.setSelectionRange(0,0),this.lastSelected=JSON.stringify(e),this._eventEmitter.emit("result",{result:e}),this.eventManager.select(e,this))},_fly:function(e){var t;if(e.properties&&pe[e.properties.short_code])t=k({},this.options.flyTo),this._map&&this._map.fitBounds(pe[e.properties.short_code].bbox,t);else if(e.bbox){var n=e.bbox;t=k({},this.options.flyTo),this._map&&this._map.fitBounds([[n[0],n[1]],[n[2],n[3]]],t)}else{var r={zoom:this.options.zoom};t=k({},r,this.options.flyTo),e.center?t.center=e.center:e.geometry&&e.geometry.type&&e.geometry.type==="Point"&&e.geometry.coordinates&&(t.center=e.geometry.coordinates),this._map&&this._map.flyTo(t)}},_requestType:function(e,t){var n;const r=/^[ ]*(-?\d+\.?\d*)[, ]+(-?\d+\.?\d*)[ ]*$/;return e.localGeocoderOnly?n=T.LOCAL:e.reverseGeocode&&r.test(t)?n=T.REVERSE:n=T.FORWARD,n},_setupConfig:function(e,t){const n=["bbox","limit","proximity","countries","types","language","reverseMode","mode","autocomplete","fuzzyMatch","routing","worldview"],r=/[\s,]+/;var i=this,o=n.reduce(function(u,a){if(i.options[a]===void 0||i.options[a]===null)return u;["countries","types","language"].indexOf(a)>-1?u[a]=i.options[a].split(r):u[a]=i.options[a];const l=typeof i.options[a].longitude=="number"&&typeof i.options[a].latitude=="number";if(a==="proximity"&&l){const c=i.options[a].longitude,f=i.options[a].latitude;u[a]=[c,f]}return u},{});switch(e){case T.REVERSE:{var s=t.split(r).map(function(u){return parseFloat(u,10)});i.options.flipCoordinates||s.reverse(),o.types&&o.types[0],o=k(o,{query:s,limit:1}),["proximity","autocomplete","fuzzyMatch","bbox"].forEach(function(u){u in o&&delete o[u]})}break;case T.FORWARD:/^[ ]*(-?\d+\.?\d*)[, ]+(-?\d+\.?\d*)*[ ]*$/.test(t)&&(t=t.replace(/,/g," ")),o=k(o,{query:t});break}return o},_geocode:function(e){this.inputString=e,this._showLoadingIcon(),this._eventEmitter.emit("loading",{query:e});const t=this._requestType(this.options,e),n=this._setupConfig(t,e);var r;switch(t){case T.LOCAL:r=Promise.resolve();break;case T.FORWARD:r=this.geocoderService.forwardGeocode(n).send();break;case T.REVERSE:r=this.geocoderService.reverseGeocode(n).send();break}var i=this.options.localGeocoder?this.options.localGeocoder(e)||[]:[],o=[],s=null;return r.catch(function(u){s=u}.bind(this)).then(function(u){this._hideLoadingIcon();var a={};return u?u.statusCode=="200"&&(a=u.body,a.request=u.request,a.headers=u.headers):a={type:"FeatureCollection",features:[]},a.config=n,this.fresh&&(this.eventManager.start(this),this.fresh=!1),a.features=a.features?i.concat(a.features):i,this.options.externalGeocoder?(o=this.options.externalGeocoder(e,a.features)||Promise.resolve([]),o.then(function(l){return a.features=a.features?l.concat(a.features):l,a},function(){return a})):a}.bind(this)).then(function(u){if(s)throw s;this.options.filter&&u.features.length&&(u.features=u.features.filter(this.options.filter)),u.features.length?(this._showClearButton(),this._hideGeolocateButton(),this._eventEmitter.emit("results",u),this._typeahead.update(u.features)):(this._hideClearButton(),this._typeahead.selected=null,this._renderNoResults(),this._eventEmitter.emit("results",u))}.bind(this)).catch(function(u){this._hideLoadingIcon(),i.length&&this.options.localGeocoder||o.length&&this.options.externalGeocoder?(this._showClearButton(),this._hideGeolocateButton(),this._typeahead.update(i)):(this._hideClearButton(),this._typeahead.selected=null,this._renderError()),this._eventEmitter.emit("results",{features:i}),this._eventEmitter.emit("error",{error:u})}.bind(this)),r},_clear:function(e){e&&e.preventDefault(),this._inputEl.value="",this._typeahead.selected=null,this._typeahead.clear(),this._onChange(),this._hideClearButton(),this._showGeolocateButton(),this._removeMarker(),this.lastSelected=null,this._eventEmitter.emit("clear"),this.fresh=!0},clear:function(e){this._clear(e),this._inputEl.focus()},_clearOnBlur:function(e){var t=this;e.relatedTarget&&t._clear(e)},_onQueryResult:function(e){var t=e.body;if(!!t.features.length){var n=t.features[0];this._typeahead.selected=n,this._inputEl.value=n.place_name,this._onChange()}},_updateProximity:function(){if(!(!this._map||!this.options.trackProximity))if(this._map.getZoom()>9){var e=this._map.getCenter().wrap();this.setProximity({longitude:e.lng,latitude:e.lat},!1)}else this.setProximity(null,!1)},_collapse:function(){!this._inputEl.value&&this._inputEl!==document.activeElement&&this.container.classList.add("mapboxgl-ctrl-geocoder--collapsed")},_unCollapse:function(){this.container.classList.remove("mapboxgl-ctrl-geocoder--collapsed")},query:function(e){return this._geocode(e).then(this._onQueryResult),this},_renderError:function(){var e="<div class='mapbox-gl-geocoder--error'>There was an error reaching the server</div>";this._renderMessage(e)},_renderLocationError:function(){var e="<div class='mapbox-gl-geocoder--error'>A location error has occurred</div>";this._renderMessage(e)},_renderNoResults:function(){var e="<div class='mapbox-gl-geocoder--error mapbox-gl-geocoder--no-results'>No results found</div>";this._renderMessage(e)},_renderUserDeniedGeolocationError:function(){var e="<div class='mapbox-gl-geocoder--error'>Geolocation permission denied</div>";this._renderMessage(e)},_renderMessage:function(e){this._typeahead.update([]),this._typeahead.selected=null,this._typeahead.clear(),this._typeahead.renderError(e)},_getPlaceholderText:function(){if(this.options.placeholder)return this.options.placeholder;if(this.options.language){var e=this.options.language.split(",")[0],t=ir.language(e),n=rr.placeholder[t];if(n)return n}return"Search"},setInput:function(e){return this._inputEl.value=e,this._typeahead.selected=null,this._typeahead.clear(),e.length>=this.options.minLength&&this._geocode(e),this},setProximity:function(e,t=!0){return this.options.proximity=e,t&&(this.options.trackProximity=!1),this},getProximity:function(){return this.options.proximity},setRenderFunction:function(e){return e&&typeof e=="function"&&(this._typeahead.render=e),this},getRenderFunction:function(){return this._typeahead.render},setLanguage:function(e){var t=navigator.language||navigator.userLanguage||navigator.browserLanguage;return this.options.language=e||this.options.language||t,this},getLanguage:function(){return this.options.language},getZoom:function(){return this.options.zoom},setZoom:function(e){return this.options.zoom=e,this},getFlyTo:function(){return this.options.flyTo},setFlyTo:function(e){return this.options.flyTo=e,this},getPlaceholder:function(){return this.options.placeholder},setPlaceholder:function(e){return this.placeholder=e||this._getPlaceholderText(),this._inputEl.placeholder=this.placeholder,this._inputEl.setAttribute("aria-label",this.placeholder),this},getBbox:function(){return this.options.bbox},setBbox:function(e){return this.options.bbox=e,this},getCountries:function(){return this.options.countries},setCountries:function(e){return this.options.countries=e,this},getTypes:function(){return this.options.types},setTypes:function(e){return this.options.types=e,this},getMinLength:function(){return this.options.minLength},setMinLength:function(e){return this.options.minLength=e,this._typeahead&&(this._typeahead.options.minLength=e),this},getLimit:function(){return this.options.limit},setLimit:function(e){return this.options.limit=e,this._typeahead&&(this._typeahead.options.limit=e),this},getFilter:function(){return this.options.filter},setFilter:function(e){return this.options.filter=e,this},setOrigin:function(e){return this.options.origin=e,this.geocoderService=J(Z({accessToken:this.options.accessToken,origin:this.options.origin})),this},getOrigin:function(){return this.options.origin},setAccessToken:function(e){return this.options.accessToken=e,this.geocoderService=J(Z({accessToken:this.options.accessToken,origin:this.options.origin})),this},setAutocomplete:function(e){return this.options.autocomplete=e,this},getAutocomplete:function(){return this.options.autocomplete},setFuzzyMatch:function(e){return this.options.fuzzyMatch=e,this},getFuzzyMatch:function(){return this.options.fuzzyMatch},setRouting:function(e){return this.options.routing=e,this},getRouting:function(){return this.options.routing},setWorldview:function(e){return this.options.worldview=e,this},getWorldview:function(){return this.options.worldview},_handleMarker:function(e){if(!!this._map){this._removeMarker();var t={color:"#4668F2"},n=k({},t,this.options.marker);return this.mapMarker=new this._mapboxgl.Marker(n),e.center?this.mapMarker.setLngLat(e.center).addTo(this._map):e.geometry&&e.geometry.type&&e.geometry.type==="Point"&&e.geometry.coordinates&&this.mapMarker.setLngLat(e.geometry.coordinates).addTo(this._map),this}},_removeMarker:function(){this.mapMarker&&(this.mapMarker.remove(),this.mapMarker=null)},on:function(e,t){return this._eventEmitter.on(e,t),this},off:function(e,t){return this._eventEmitter.removeListener(e,t),this.eventManager.remove(),this}};var ur=We;function cr(e){return Je(()=>new ur(e),{position:e.position}),null}export{cr as default};
//# sourceMappingURL=geocoder-control.d0faae93.js.map
