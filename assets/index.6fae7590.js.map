{"version":3,"file":"index.6fae7590.js","sources":["../../vite/modulepreload-polyfill","../../vite/preload-helper","../../src/apis.js","../../src/ls.js","../../assets/pin.png","../../assets/walk-dot-blue.png","../../assets/walk-dot-purple.png","../../assets/walk-dot-red.png","../../assets/icon-192.png","../../preact/jsx-runtime","../../src/app.jsx","../../src/main.jsx"],"sourcesContent":["const p = function polyfill() {\n    const relList = document.createElement('link').relList;\n    if (relList && relList.supports && relList.supports('modulepreload')) {\n        return;\n    }\n    for (const link of document.querySelectorAll('link[rel=\"modulepreload\"]')) {\n        processPreload(link);\n    }\n    new MutationObserver((mutations) => {\n        for (const mutation of mutations) {\n            if (mutation.type !== 'childList') {\n                continue;\n            }\n            for (const node of mutation.addedNodes) {\n                if (node.tagName === 'LINK' && node.rel === 'modulepreload')\n                    processPreload(node);\n            }\n        }\n    }).observe(document, { childList: true, subtree: true });\n    function getFetchOpts(script) {\n        const fetchOpts = {};\n        if (script.integrity)\n            fetchOpts.integrity = script.integrity;\n        if (script.referrerpolicy)\n            fetchOpts.referrerPolicy = script.referrerpolicy;\n        if (script.crossorigin === 'use-credentials')\n            fetchOpts.credentials = 'include';\n        else if (script.crossorigin === 'anonymous')\n            fetchOpts.credentials = 'omit';\n        else\n            fetchOpts.credentials = 'same-origin';\n        return fetchOpts;\n    }\n    function processPreload(link) {\n        if (link.ep)\n            // ep marker = processed\n            return;\n        link.ep = true;\n        // prepopulate the load record\n        const fetchOpts = getFetchOpts(link);\n        fetch(link.href, fetchOpts);\n    }\n};__VITE_IS_MODERN__&&p();","const scriptRel = 'modulepreload';const seen = {};const base = './';export const __vitePreload = function preload(baseModule, deps) {\n    // @ts-ignore\n    if (!__VITE_IS_MODERN__ || !deps || deps.length === 0) {\n        return baseModule();\n    }\n    return Promise.all(deps.map((dep) => {\n        // @ts-ignore\n        dep = `${base}${dep}`;\n        // @ts-ignore\n        if (dep in seen)\n            return;\n        // @ts-ignore\n        seen[dep] = true;\n        const isCss = dep.endsWith('.css');\n        const cssSelector = isCss ? '[rel=\"stylesheet\"]' : '';\n        // @ts-ignore check if the file is already preloaded by SSR markup\n        if (document.querySelector(`link[href=\"${dep}\"]${cssSelector}`)) {\n            return;\n        }\n        // @ts-ignore\n        const link = document.createElement('link');\n        // @ts-ignore\n        link.rel = isCss ? 'stylesheet' : scriptRel;\n        if (!isCss) {\n            link.as = 'script';\n            link.crossOrigin = '';\n        }\n        link.href = dep;\n        // @ts-ignore\n        document.head.appendChild(link);\n        if (isCss) {\n            return new Promise((res, rej) => {\n                link.addEventListener('load', res);\n                link.addEventListener('error', () => rej(new Error(`Unable to preload CSS for ${dep}`)));\n            });\n        }\n    })).then(() => baseModule());\n}","const {\n  VITE_ORS_API_KEY: ORS_API_KEY,\n  VITE_GRAPHHOPPER_API_KEY: GRAPHHOPPER_API_KEY,\n} = import.meta.env;\n\nconst APIS = {\n  OSRM: (origin, destination) =>\n    `https://routing.openstreetmap.de/routed-foot/route/v1/driving/${origin.join(\n      ',',\n    )};${destination.join(',')}`,\n  ORS: () =>\n    `https://api.openrouteservice.org/v2/directions/foot-hiking/geojson`,\n  GHOP: () => `https://graphhopper.com/api/1/route`,\n};\n\nexport const fetchRoutes = async (origin, destination, params) => {\n  const fetch1 = fetch(\n    APIS.OSRM(origin, destination) +\n      '?' +\n      new URLSearchParams({\n        geometries: 'geojson',\n        overview: 'full',\n        continue_straight: false,\n        generate_hints: false,\n        alternatives: 1,\n        ...params,\n      }),\n  )\n    .then((r) => r.json())\n    .catch((e) => {});\n\n  const fetch2 = fetch(APIS.ORS(), {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      Authorization: ORS_API_KEY,\n    },\n    body: JSON.stringify({\n      coordinates: [origin, destination],\n      instructions: false,\n      alternative_routes: {\n        target_count: 2,\n      },\n    }),\n  })\n    .then((r) => r.json())\n    .catch((e) => {});\n\n  const fetch3Params = new URLSearchParams({\n    vehicle: 'foot',\n    key: GRAPHHOPPER_API_KEY,\n    instructions: true,\n    points_encoded: false,\n    point: [...origin].reverse().join(','),\n    algorithm: 'alternative_route',\n    'alternative_route.max_paths': 2,\n  });\n  fetch3Params.append('point', [...destination].reverse().join(','));\n  const fetch3 = fetch(APIS.GHOP() + '?' + fetch3Params)\n    .then((r) => r.json())\n    .catch((e) => {});\n\n  const [response1, response2, response3] = await Promise.all([\n    fetch1,\n    fetch2,\n    fetch3,\n  ]);\n\n  console.log({\n    response1,\n    response2,\n    response3,\n  });\n\n  const results = {\n    type: 'FeatureCollection',\n    features: [\n      ...response1?.routes.map((route, index) => {\n        return {\n          type: 'Feature',\n          geometry: route?.geometry,\n          properties: {\n            index,\n            provider: 'osrm',\n            distance: route?.distance,\n          },\n        };\n      }),\n      ...response2?.features.map((feature, index) => {\n        return {\n          type: 'Feature',\n          geometry: feature?.geometry,\n          properties: {\n            index,\n            provider: 'ors',\n            distance: feature?.properties?.summary?.distance,\n          },\n        };\n      }),\n      ...response3?.paths.map((path, index) => {\n        return {\n          type: 'Feature',\n          geometry: path?.points,\n          properties: {\n            index,\n            provider: 'graphhopper',\n            distance: path?.distance,\n          },\n        };\n      }),\n    ],\n  };\n\n  return results;\n};\n","const LS_PREFIX = 'mapwalker-';\n\nexport default {\n  get: (key) => {\n    try {\n      return JSON.parse(localStorage.getItem(LS_PREFIX + key));\n    } catch (e) {\n      return null;\n    }\n  },\n  set: (key, value) => {\n    try {\n      if (value) {\n        localStorage.setItem(LS_PREFIX + key, JSON.stringify(value));\n      } else {\n        localStorage.removeItem(LS_PREFIX + key);\n      }\n    } catch (e) {\n      // ignore\n    }\n  },\n  del: (key) => {\n    try {\n      localStorage.removeItem(LS_PREFIX + key);\n    } catch (e) {\n      // ignore\n    }\n  },\n};\n","export default \"data:image/png;base64,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\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABL0lEQVR4AWJwL/ABlE7V2A0EUWx7U7sXSB2qc6JMF7xEmLnbPUWYqU4qs5swM335jZy/E44LGSWN5n9tBK+vr3WCZkEomLeYEHQIfJevhXErnP8B4MSp0+IJEA6vn5ZbF44yTUHpNNmbeQXqZwqXA7tne06ieMWAJ+8f36/XjOdvKXSB/8BhEmgh9umsxYmezE6qNx0A8rmkTZDSauo8O5z5QYlIUqonM5bqyzVGkRnj/61zRxlrYDzeHfcsE+Q0ilwk+jI74GA+1iD0GL8SHbG/MuhOB+RRV70BC4NYHN6XBr2ZEtfKdcLA4AsGozYw9kGshjj43onOcnVZIKcDJbXGHb1GVSifRTL/KJL5tMrsBNfKtbXJFZHy0yrThEl+gHEfJg1Wu5OJLEIrrHP5b3P6pThmM9CwAAAAAElFTkSuQmCC\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAZlBMVEVHcEz///+zAKG6GKn///////+zAJ////+0AKD///+6GKr///////////+yAKG9Ja/TbcmyAKHz1e+0AKDz1fDdjtX46vfdjdX46viyAKH////CM7T////CM7O0AKC9Ja7TbMmzAKF6zRIdAAAAIXRSTlMAa+X3m2ymvzMM9xgwp8zz35nHmcfXw9fDpnjvd+/M898tOvE7AAAAlUlEQVR4XmXPSWLDMAwEQZAi2Zap3fuWZP7/yUjC0XWbPgG26UIP6V3NtQFHaPeduE8vabxA2krgfNTueCaYVVj3TylxLXc6e3ORTofVSZrIlhgVD7tBH3oDqXgoEnyHno8GD1G/JMtM0rztWbrxtI5rI8XHY5AaqGaZpdGuWch+OrdRev1dSf5MxpFbc/WZoM/dNv4BxucM0w0EVH0AAAAASUVORK5CYII=\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAV1BMVEVHcEz////////////////////////////////87PDzfZnuSnHrHk7uPmf1m7D72+LsM17rHk7pHk7qHk397PD1m6/rHk7rHlD////rHk7tPmfzfpr///8RMzXWAAAAHXRSTlMAMGunv5t3GAzD3+//89fH98ym5cPXmTNspvPfeD/z9xIAAACOSURBVHgBZc/VgYAwEEXRIVz84S7917lAsn6+IqP2iFwMSZqZlzsCl7/3hKKspLqB5HlxtJ1eXYszy+C+98Mw3i8TkaXM0rLeFqlks4Ra4/rqVREbSLt/2CX4/xBTqfcPow4S2zi/izZcFjHdbcdh6O+2kJltPwfb/Og0tVSdBYlfZiPYcvOyK4F4i+z2AXk5CstVjWTDAAAAAElFTkSuQmCC\"","export default \"data:image/png;base64,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\"","import * as jsxRuntime from \"/home/runner/work/mapwalker/mapwalker/node_modules/preact/jsx-runtime/dist/jsxRuntime.js\"\nexport const jsx = jsxRuntime.jsx\nexport const jsxs = jsxRuntime.jsxs\nexport const Fragment = jsxRuntime.Fragment","import {\n  useRef,\n  useState,\n  useEffect,\n  useMemo,\n  useCallback,\n} from 'preact/hooks';\nimport { Suspense, lazy } from 'preact/compat';\nimport mapboxgl from 'mapbox-gl';\nimport Map, {\n  AttributionControl,\n  GeolocateControl,\n  Layer,\n  Marker,\n  NavigationControl,\n  Source,\n} from 'react-map-gl';\nimport AwesomeDebouncePromise from 'awesome-debounce-promise';\nimport { BottomSheet } from 'react-spring-bottom-sheet';\nimport prettyMetric from 'pretty-metric';\nimport prettyImperial from 'pretty-imperial';\nimport humanizeDuration from 'humanize-duration';\nimport haversine from 'haversine-distance';\nimport { useRect } from '@reach/rect';\nimport usePageVisibility from 'use-page-visibility';\n\nimport { fetchRoutes } from './apis';\nimport LS from './ls';\nimport pinImgURL from '../assets/pin.png';\nimport walkDotBlueImgURL from '../assets/walk-dot-blue.png';\nimport walkDotPurpleImgURL from '../assets/walk-dot-purple.png';\nimport walkDotRedImgURL from '../assets/walk-dot-red.png';\nimport iconImgURL from '../assets/icon-192.png';\n\nconst { VITE_MAPBOX_ACCESS_TOKEN: MAPBOX_ACCESS_TOKEN, DEV } = import.meta.env;\n\nconst OVERVIEW_ZOOM_BACK = 2;\nconst POINTER_PADDING = 10;\n\nconst MAPSTYLE = `mapbox://styles/cheeaun/cl0ds1jbz003014px6nthvdle${\n  DEV ? '/draft' : ''\n}`;\n\nconst emptyGeoJSON = {\n  type: 'FeatureCollection',\n  features: [],\n};\n\nconst mapStyles = {\n  walkRoute: {\n    layout: {\n      'line-join': 'round',\n      'line-cap': 'round',\n    },\n    paint: {\n      'line-color': [\n        'case',\n        ['==', ['get', 'provider'], 'ors'],\n        '#95378C',\n        ['==', ['get', 'provider'], 'graphhopper'],\n        '#EB1E4E',\n        '#0E90DF',\n      ],\n      'line-opacity': ['interpolate', ['linear'], ['zoom'], 15, 1, 18, 0.5],\n      'line-width': ['interpolate', ['linear'], ['zoom'], 15, 4, 18, 14],\n      'line-dasharray': [0, 2],\n    },\n  },\n  walkRoute2: {\n    layout: {\n      'symbol-placement': 'line',\n      'symbol-spacing': ['interpolate', ['linear'], ['zoom'], 15, 1, 19, 56],\n      // 'icon-allow-overlap': true,\n      // 'icon-ignore-placement': true,\n      'icon-padding': 0,\n      'icon-size': ['interpolate', ['linear'], ['zoom'], 15, 0.5, 18, 1],\n      'icon-image': [\n        'case',\n        ['==', ['get', 'provider'], 'ors'],\n        'walk-dot-purple',\n        ['==', ['get', 'provider'], 'graphhopper'],\n        'walk-dot-red',\n        'walk-dot-blue',\n      ],\n    },\n  },\n};\n\nlet orientationGranted = false;\nfunction requestOrientation(fn = () => {}) {\n  if (window.DeviceOrientationEvent && !orientationGranted) {\n    if (typeof DeviceOrientationEvent.requestPermission === 'function') {\n      DeviceOrientationEvent.requestPermission()\n        .then(function (permissionState) {\n          if (permissionState === 'granted') {\n            console.log('granted');\n            orientationGranted = true;\n            fn();\n          }\n        })\n        .catch((e) => {});\n    }\n  }\n}\n\nconst GeocoderControl = lazy(() => import('./geocoder-control'));\n\nfunction bearingDegrees(x1, y1, x2, y2) {\n  const radians = Math.atan2(y2 - y1, x2 - x1);\n  return (radians * 180) / Math.PI;\n}\n\nfunction hasHeading() {\n  return document.querySelector('.mapboxgl-user-location-show-heading');\n}\n\nfunction sleep(ms) {\n  return new Promise((resolve) => setTimeout(resolve, ms));\n}\n\nexport function App() {\n  const mapDivRef = useRef();\n  const mapRef = useRef();\n  const overviewMapDivRef = useRef();\n  const overviewMapRef = useRef();\n\n  const [loading, setLoading] = useState(false);\n\n  const geolocateControlRef = useRef();\n  const [geolocationGeoJSON, setGeolocationGeoJSON] = useState(emptyGeoJSON);\n\n  const [walkRouteGeoJSON, setWalkRouteGeoJSON] = useState(\n    LS.get('walk-route') || null,\n  );\n  useEffect(() => {\n    LS.set('walk-route', walkRouteGeoJSON);\n  }, [walkRouteGeoJSON]);\n\n  const [destinationMarker, setDestinationMarker] = useState(\n    LS.get('destination-marker') || null,\n  );\n  useEffect(() => {\n    LS.set('destination-marker', destinationMarker);\n  }, [destinationMarker]);\n\n  const [markerPinned, setMarkerPinned] = useState(\n    LS.get('marker-pinned') || false,\n  );\n  useEffect(() => {\n    LS.set('marker-pinned', markerPinned);\n  }, [markerPinned]);\n\n  const clickFired = useRef(false);\n  const mapHandleClick = (e) => {\n    if (clickFired.current && !markerPinned) {\n      const { lngLat } = e;\n      setDestinationMarker(lngLat);\n    }\n  };\n  const mapHandleClickDebounced = AwesomeDebouncePromise(mapHandleClick, 350);\n\n  const [mapTextLayerID, setMapTextLayerID] = useState(null);\n  const [legendSheetOpen, setLegendSheetOpen] = useState(false);\n  const [optionsSheetOpen, setOptionsSheetOpen] = useState(false);\n  const [markerSheetOpen, setMarkerSheetOpen] = useState(false);\n  const [aboutSheetOpen, setAboutSheetOpen] = useState(\n    LS.get('not-first-time') ? false : true,\n  );\n  const backupDestinationMarker = useRef(destinationMarker);\n  const backupWalkRouteGeoJSON = useRef(walkRouteGeoJSON);\n\n  const distances = useMemo(() => {\n    const info = {};\n    walkRouteGeoJSON?.features?.forEach((feature) => {\n      const { provider, distance } = feature.properties;\n      if (!info[provider]) {\n        info[provider] = [];\n      }\n      info[provider].push(distance);\n    });\n    return info;\n  }, [walkRouteGeoJSON]);\n\n  const [sheetOpen, setSheetOpen] = useState(false);\n  useEffect(() => {\n    if (aboutSheetOpen || markerSheetOpen || legendSheetOpen) {\n      setSheetOpen(true);\n    } else if (sheetOpen) {\n      setTimeout(() => {\n        setSheetOpen(false);\n      }, 300);\n    }\n  }, [legendSheetOpen, markerSheetOpen, aboutSheetOpen]);\n\n  const [overviewMapExpanded, setOverviewMapExpanded] = useState(false);\n  useEffect(() => {\n    mapRef.current?.resize();\n    overviewMapRef.current?.resize();\n    if (geolocationGeoJSON) {\n      setGeolocateActiveLock();\n    }\n  }, [overviewMapExpanded]);\n\n  const aboutSheetInitialFocusRef = useRef();\n  const markerSheetInitialFocusRef = useRef();\n\n  const airDistanceToMarker = useMemo(() => {\n    if (!destinationMarker || !geolocationGeoJSON?.features?.length) return 0;\n    const { lng, lat } = destinationMarker;\n    const [originLng, originLat] =\n      geolocationGeoJSON.features[0].geometry.coordinates;\n    return haversine(\n      {\n        longitude: originLng,\n        latitude: originLat,\n      },\n      {\n        longitude: lng,\n        latitude: lat,\n      },\n    );\n  }, [destinationMarker, geolocationGeoJSON]);\n\n  const requestOrientationTriggerGeolocation = useCallback(() => {\n    if (geolocationGeoJSON && !hasHeading()) {\n      requestOrientation(async () => {\n        let times = 0;\n        do {\n          if (times++ > 10) break; // Prevent infinite loop\n          geolocateControlRef.current?.trigger();\n          await sleep(100);\n        } while (!hasHeading());\n      });\n    }\n  }, [geolocationGeoJSON]);\n\n  const markerPointerRef = useRef();\n  const markerPointerMiniRef = useRef();\n\n  const mapRect = useRect(mapDivRef);\n  const overviewMapRect = useRect(overviewMapDivRef);\n\n  const renderMapArrow = useCallback(() => {\n    if (destinationMarker && markerPointerRef.current) {\n      const { width, height } = mapRect;\n\n      const { lng, lat } = destinationMarker;\n      const { x, y } = mapRef.current.project([lng, lat]);\n      const constrainedX = Math.max(\n        Math.min(x, width - POINTER_PADDING),\n        POINTER_PADDING,\n      );\n      const constrainedY = Math.max(\n        Math.min(y, height - POINTER_PADDING),\n        POINTER_PADDING,\n      );\n\n      // center point of map\n      const centerX = width / 2;\n      const centerY = height / 2;\n\n      // bearing in degrees, from center to destination\n      const bearing = bearingDegrees(centerX, centerY, x, y);\n\n      if (\n        constrainedX < x + POINTER_PADDING &&\n        constrainedX > x - POINTER_PADDING &&\n        constrainedY < y + POINTER_PADDING &&\n        constrainedY > y - POINTER_PADDING\n      ) {\n        markerPointerRef.current.hidden = true;\n      } else {\n        markerPointerRef.current.hidden = false;\n        markerPointerRef.current.style.transform = `translate(${constrainedX}px, ${constrainedY}px) rotate(${\n          bearing + 90\n        }deg)`;\n      }\n    } else {\n      markerPointerRef.current.hidden = true;\n    }\n  }, [destinationMarker, mapRect]);\n\n  const renderOverviewMapArrow = useCallback(() => {\n    if (destinationMarker && markerPointerMiniRef.current) {\n      const { width, height } = overviewMapRect;\n\n      const { lng, lat } = destinationMarker;\n      const { x, y } = overviewMapRef.current.project([lng, lat]);\n      const constrainedX = Math.max(\n        Math.min(x, width - POINTER_PADDING),\n        POINTER_PADDING,\n      );\n      const constrainedY = Math.max(\n        Math.min(y, height - POINTER_PADDING),\n        POINTER_PADDING,\n      );\n\n      // center point of map\n      const centerX = width / 2;\n      const centerY = height / 2;\n\n      // bearing in degrees, from center to destination\n      const bearing = bearingDegrees(centerX, centerY, x, y);\n\n      if (\n        constrainedX < x + POINTER_PADDING &&\n        constrainedX > x - POINTER_PADDING &&\n        constrainedY < y + POINTER_PADDING &&\n        constrainedY > y - POINTER_PADDING\n      ) {\n        markerPointerMiniRef.current.hidden = true;\n      } else {\n        markerPointerMiniRef.current.hidden = false;\n        markerPointerMiniRef.current.style.transform = `translate(${constrainedX}px, ${constrainedY}px) rotate(${\n          bearing + 90\n        }deg)`;\n      }\n    } else {\n      markerPointerMiniRef.current.hidden = true;\n    }\n  }, [destinationMarker, overviewMapRect]);\n\n  const geolocateState = useRef(null);\n  const setGeolocateActiveLock = useCallback(() => {\n    if (\n      geolocateState.current !== 'ACTIVE_LOCK' ||\n      !document.querySelector('.mapboxgl-ctrl-geolocate-active')\n    ) {\n      geolocateControlRef.current?.trigger();\n    }\n  }, []);\n  usePageVisibility((visible) => {\n    if (visible) {\n      setGeolocateActiveLock();\n      if (geolocationGeoJSON) {\n        overviewMapRef.current?.easeTo({\n          center: geolocationGeoJSON.features[0].geometry.coordinates,\n        });\n      }\n    }\n  });\n\n  const zoomWholeRoute = useCallback((routeGeoJSON) => {\n    if (!routeGeoJSON) return;\n    const bounds = new mapboxgl.LngLatBounds();\n    routeGeoJSON.features.forEach((feature) => {\n      feature.geometry.coordinates.forEach((coord) => {\n        bounds.extend(coord);\n      });\n    });\n    mapRef.current?.fitBounds(bounds, {\n      padding: 100,\n    });\n  }, []);\n\n  const [theme, setTheme] = useState(LS.get('theme') || 'auto');\n  useEffect(() => {\n    const html = document.documentElement;\n    const colorSchemeMeta = document.querySelector('meta[name=\"color-scheme\"]');\n    if (theme === 'light') {\n      html.classList.add('is-light');\n      html.classList.remove('is-dark');\n      colorSchemeMeta?.setAttribute('content', 'light');\n      LS.set('theme', theme);\n    } else if (theme === 'dark') {\n      html.classList.add('is-dark');\n      html.classList.remove('is-light');\n      colorSchemeMeta?.setAttribute('content', 'dark');\n      LS.set('theme', theme);\n    } else {\n      html.classList.remove('is-dark', 'is-light');\n      colorSchemeMeta?.setAttribute('content', 'light dark');\n      LS.del('theme');\n    }\n  }, [theme]);\n\n  const [unitSystem, setUnitSystem] = useState(\n    LS.get('unit-system') || 'metric',\n  );\n  useEffect(() => {\n    if (unitSystem === 'imperial') {\n      LS.set('unit-system', unitSystem);\n    } else {\n      LS.del('unit-system');\n    }\n  }, [unitSystem]);\n  const prettyUnit = useCallback(\n    (d) => {\n      // d = number in meters\n      if (unitSystem === 'imperial') {\n        // convert meter to miles\n        const miles = d / 1609.34;\n        return prettyImperial(miles).input('mi').humanize();\n      }\n      return prettyMetric(d).humanize();\n    },\n    [unitSystem],\n  );\n\n  const routeInfoText = useCallback(\n    (distance) => {\n      // Walking speed: 1.33m per second\n      const timeDurationSecs = (distance / 1.33) * 1000;\n      return `${prettyUnit(distance)} (${humanizeDuration(timeDurationSecs, {\n        units: ['h', 'm'],\n        round: true,\n      })})`;\n    },\n    [prettyUnit],\n  );\n\n  const [showMiniLocationButton, setShowMiniLocationButton] = useState(false);\n\n  return (\n    <div class={`${overviewMapExpanded ? 'split-view' : ''}`}>\n      <div id=\"map\" ref={mapDivRef}>\n        <Map\n          ref={mapRef}\n          mapboxAccessToken={MAPBOX_ACCESS_TOKEN}\n          mapStyle={MAPSTYLE}\n          initialViewState={\n            LS.get('view-state') || {\n              longitude: 0,\n              latitude: 0,\n            }\n          }\n          boxZoom={false}\n          renderWorldCopies={false}\n          maxZoom={21}\n          attributionControl={false}\n          logoPosition=\"top-right\"\n          keyboard={false}\n          onLoad={(e) => {\n            setGeolocateActiveLock();\n\n            const { layers } = mapRef.current.getStyle();\n            setMapTextLayerID(\n              layers.find(\n                (layer) =>\n                  layer.type === 'symbol' && layer?.layout?.['text-field'],\n              )?.id,\n            );\n\n            mapRef.current.loadImage(walkDotBlueImgURL, (error, image) => {\n              if (error) return;\n              mapRef.current.addImage('walk-dot-blue', image);\n              overviewMapRef.current.addImage('walk-dot-blue', image);\n            });\n            mapRef.current.loadImage(walkDotPurpleImgURL, (error, image) => {\n              if (error) return;\n              mapRef.current.addImage('walk-dot-purple', image);\n              overviewMapRef.current.addImage('walk-dot-purple', image);\n            });\n            mapRef.current.loadImage(walkDotRedImgURL, (error, image) => {\n              if (error) return;\n              mapRef.current.addImage('walk-dot-red', image);\n              overviewMapRef.current.addImage('walk-dot-red', image);\n            });\n          }}\n          onMoveStart={(e) => {\n            if (e.geolocateSource) return;\n            if (!overviewMapDivRef.current.hidden) {\n              overviewMapDivRef.current.classList.add('faded');\n            }\n          }}\n          onMoveEnd={(e) => {\n            if (e.geolocateSource) return;\n            if (!overviewMapDivRef.current.hidden) {\n              overviewMapDivRef.current.classList.remove('faded');\n            }\n          }}\n          onIdle={(e) => {\n            if (!overviewMapDivRef.current.hidden) {\n              overviewMapDivRef.current.classList.remove('faded');\n            }\n\n            const { target } = e;\n            const center = target.getCenter();\n            const viewState = {\n              longitude: center.lng,\n              latitude: center.lat,\n              zoom: target.getZoom(),\n              bearing: target.getBearing(),\n              pitch: target.getPitch(),\n            };\n            LS.set('view-state', viewState);\n\n            renderMapArrow();\n\n            const hideNavControl =\n              viewState.pitch === 0 && viewState.bearing === 0;\n            document.querySelector(\n              '#map .mapboxgl-ctrl-compass',\n            ).style.display = hideNavControl ? 'none' : 'block';\n          }}\n          onMove={(e) => {\n            const { viewState } = e;\n            const lowZoomLevel = viewState.zoom < 16;\n            overviewMapDivRef.current.hidden = lowZoomLevel;\n            if (!lowZoomLevel && !overviewMapExpanded) {\n              overviewMapRef.current?.jumpTo({\n                ...viewState,\n                center: [viewState.longitude, viewState.latitude],\n                zoom: viewState.zoom - OVERVIEW_ZOOM_BACK,\n              });\n            }\n\n            renderMapArrow();\n          }}\n          onClick={(e) => {\n            console.log('map click', e);\n            if (e.originalEvent.detail > 1) return;\n            clickFired.current = true;\n            mapHandleClickDebounced(e);\n            requestOrientationTriggerGeolocation();\n          }}\n          onDblClick={(e) => {\n            if (clickFired.current) {\n              clickFired.current = false;\n            }\n          }}\n          onZoomStart={(e) => {\n            if (clickFired.current) {\n              clickFired.current = false;\n            }\n          }}\n          onZoomEnd={(e) => {\n            const { zoom } = e.viewState;\n            console.log('zoom', zoom);\n          }}\n          onDragStart={(e) => {\n            if (clickFired.current) {\n              clickFired.current = false;\n            }\n          }}\n        >\n          <AttributionControl position=\"top-right\" compact />\n          <Source\n            id=\"walk-route\"\n            type=\"geojson\"\n            data={walkRouteGeoJSON || emptyGeoJSON}\n          >\n            {/* <Layer id=\"walk-route\" type=\"line\" {...mapStyles.walkRoute} /> */}\n            <Layer id=\"walk-route\" type=\"symbol\" {...mapStyles.walkRoute2} />\n          </Source>\n          <Marker\n            anchor=\"bottom\"\n            draggable={!markerPinned}\n            longitude={destinationMarker?.lng || 0}\n            latitude={destinationMarker?.lat || 0}\n            onDragEnd={(e) => {\n              const { lngLat } = e;\n              setDestinationMarker(lngLat);\n            }}\n            onClick={(e) => {\n              e.originalEvent.stopPropagation();\n              setMarkerSheetOpen(true);\n            }}\n          >\n            <img src={pinImgURL} width=\"18\" hidden={!destinationMarker} />\n          </Marker>\n          <Suspense>\n            <GeocoderControl\n              accessToken={MAPBOX_ACCESS_TOKEN}\n              marker={false}\n              clearAndBlurOnSelect={true}\n              collapsed={true}\n              position=\"top-left\"\n            />\n          </Suspense>\n          <GeolocateControl\n            ref={geolocateControlRef}\n            fitBoundsOptions={{\n              zoom: 17,\n            }}\n            positionOptions={{\n              enableHighAccuracy: true,\n              timeout: 5000,\n            }}\n            trackUserLocation\n            showUserHeading\n            position=\"bottom-right\"\n            onGeolocate={(e) => {\n              const {\n                target: { _watchState },\n                coords,\n              } = e;\n              console.log(_watchState, { onGeolocate: e });\n              geolocateState.current = _watchState;\n              if (coords?.longitude) {\n                setGeolocationGeoJSON({\n                  type: 'FeatureCollection',\n                  features: [\n                    {\n                      type: 'Feature',\n                      geometry: {\n                        type: 'Point',\n                        coordinates: [coords.longitude, coords.latitude],\n                      },\n                    },\n                  ],\n                });\n\n                requestOrientation();\n              } else {\n                setGeolocationGeoJSON(null);\n              }\n            }}\n            onError={(e) => {\n              const { code, message } = e;\n              // 1. PERMISSION_DENIED\n              // 2. POSITION_UNAVAILABLE\n              // 3. TIMEOUT\n              if (code !== 3) {\n                alert(`${code}: ${message}`);\n              }\n              setGeolocationGeoJSON(null);\n            }}\n          />\n          <NavigationControl\n            showZoom={false}\n            visualizePitch\n            position=\"bottom-right\"\n          />\n          <div class=\"marker-pointer\" ref={markerPointerRef} hidden />\n          <div id=\"actions\">\n            <button\n              type=\"button\"\n              onClick={() => {\n                setAboutSheetOpen(true);\n              }}\n              title=\"About\"\n            >\n              <svg height=\"24\" viewBox=\"0 0 24 24\" width=\"24\">\n                <path\n                  fill=\"currentColor\"\n                  d=\"m11 7h2v2h-2zm0 4h2v6h-2zm1-9c-5.52 0-10 4.48-10 10s4.48 10 10 10 10-4.48 10-10-4.48-10-10-10zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z\"\n                />\n              </svg>\n            </button>\n            <button\n              type=\"button\"\n              onClick={() => {\n                setLegendSheetOpen(true);\n              }}\n              title=\"Legend\"\n            >\n              <svg height=\"24\" viewBox=\"0 0 24 24\" width=\"24\">\n                <path\n                  fill=\"currentColor\"\n                  d=\"m11 18h2v-2h-2zm1-16c-5.52 0-10 4.48-10 10s4.48 10 10 10 10-4.48 10-10-4.48-10-10-10zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm0-14c-2.21 0-4 1.79-4 4h2c0-1.1.9-2 2-2s2 .9 2 2c0 2-3 1.75-3 5h2c0-2.25 3-2.5 3-5 0-2.21-1.79-4-4-4z\"\n                />\n              </svg>\n            </button>\n            <button\n              type=\"button\"\n              onClick={() => {\n                setOptionsSheetOpen(true);\n              }}\n              title=\"Options\"\n            >\n              <svg height=\"24\" viewBox=\"0 0 24 24\" width=\"24\">\n                <path\n                  fill=\"currentColor\"\n                  d=\"m19.43 12.98c.04-.32.07-.64.07-.98s-.03-.66-.07-.98l2.11-1.65c.19-.15.24-.42.12-.64l-2-3.46c-.09-.16-.26-.25-.44-.25-.06 0-.12.01-.17.03l-2.49 1c-.52-.4-1.08-.73-1.69-.98l-.38-2.65c-.03-.24-.24-.42-.49-.42h-4c-.25 0-.46.18-.49.42l-.38 2.65c-.61.25-1.17.59-1.69.98l-2.49-1c-.06-.02-.12-.03-.18-.03-.17 0-.34.09-.43.25l-2 3.46c-.13.22-.07.49.12.64l2.11 1.65c-.04.32-.07.65-.07.98s.03.66.07.98l-2.11 1.65c-.19.15-.24.42-.12.64l2 3.46c.09.16.26.25.44.25.06 0 .12-.01.17-.03l2.49-1c.52.4 1.08.73 1.69.98l.38 2.65c.03.24.24.42.49.42h4c.25 0 .46-.18.49-.42l.38-2.65c.61-.25 1.17-.59 1.69-.98l2.49 1c.06.02.12.03.18.03.17 0 .34-.09.43-.25l2-3.46c.12-.22.07-.49-.12-.64zm-1.98-1.71c.04.31.05.52.05.73s-.02.43-.05.73l-.14 1.13.89.7 1.08.84-.7 1.21-1.27-.51-1.04-.42-.9.68c-.43.32-.84.56-1.25.73l-1.06.43-.16 1.13-.2 1.35h-1.4l-.19-1.35-.16-1.13-1.06-.43c-.43-.18-.83-.41-1.23-.71l-.91-.7-1.06.43-1.27.51-.7-1.21 1.08-.84.89-.7-.14-1.13c-.03-.31-.05-.54-.05-.74s.02-.43.05-.73l.14-1.13-.89-.7-1.08-.84.7-1.21 1.27.51 1.04.42.9-.68c.43-.32.84-.56 1.25-.73l1.06-.43.16-1.13.2-1.35h1.39l.19 1.35.16 1.13 1.06.43c.43.18.83.41 1.23.71l.91.7 1.06-.43 1.27-.51.7 1.21-1.07.85-.89.7zm-5.45-3.27c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm0 6c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2z\"\n                />\n              </svg>\n            </button>\n            <button\n              type=\"button\"\n              class=\"bold\"\n              onClick={() => {\n                setMarkerSheetOpen(true);\n              }}\n              title=\"Actions\"\n              disabled={loading}\n            >\n              {loading ? (\n                <div class=\"loading\" />\n              ) : (\n                <svg height=\"24\" viewBox=\"0 0 24 24\" width=\"24\">\n                  <path\n                    fill=\"currentColor\"\n                    d=\"m3 3v8h8v-8zm6 6h-4v-4h4zm-6 4v8h8v-8zm6 6h-4v-4h4zm4-16v8h8v-8zm6 6h-4v-4h4zm-6 4v8h8v-8zm6 6h-4v-4h4z\"\n                  />\n                </svg>\n              )}\n            </button>\n          </div>\n        </Map>\n      </div>\n      <div id=\"overview-map\" ref={overviewMapDivRef} hidden>\n        <Map\n          ref={overviewMapRef}\n          mapboxAccessToken={MAPBOX_ACCESS_TOKEN}\n          mapStyle={MAPSTYLE}\n          initialViewState={{\n            longitude: 0,\n            latitude: 0,\n          }}\n          attributionControl={false}\n          interactive={!overviewMapExpanded}\n          maxZoom={17}\n          keyboard={false}\n          onClick={() => {\n            requestOrientationTriggerGeolocation();\n          }}\n          onIdle={() => {\n            renderOverviewMapArrow();\n\n            const pitch = overviewMapRef.current.getPitch();\n            const bearing = overviewMapRef.current.getBearing();\n            const hideNavControl = pitch === 0 && bearing === 0;\n            document.querySelector(\n              '#overview-map .mapboxgl-ctrl-compass',\n            ).style.display = hideNavControl ? 'none' : 'block';\n\n            // check  if geolocationGeoJSON is in view\n            const overviewMapBounds = overviewMapRef.current.getBounds();\n            const isInBounds = overviewMapBounds.contains(\n              geolocationGeoJSON?.features[0].geometry.coordinates,\n            );\n            setShowMiniLocationButton(!isInBounds);\n          }}\n          onMove={renderOverviewMapArrow}\n        >\n          <NavigationControl\n            showZoom={false}\n            visualizePitch\n            position=\"bottom-right\"\n          />\n          <Source\n            id=\"walk-route\"\n            type=\"geojson\"\n            data={walkRouteGeoJSON || emptyGeoJSON}\n          >\n            {/* <Layer id=\"walk-route\" type=\"line\" {...mapStyles.walkRoute} /> */}\n            <Layer id=\"walk-route\" type=\"symbol\" {...mapStyles.walkRoute2} />\n          </Source>\n          <Marker\n            anchor=\"center\"\n            longitude={\n              geolocationGeoJSON?.features[0]?.geometry?.coordinates[0] || 0\n            }\n            latitude={\n              geolocationGeoJSON?.features[0]?.geometry?.coordinates[1] || 0\n            }\n          >\n            <div id=\"geolocation-marker\" hidden={!geolocationGeoJSON} />\n          </Marker>\n          <Marker\n            anchor=\"bottom\"\n            longitude={destinationMarker?.lng || 0}\n            latitude={destinationMarker?.lat || 0}\n          >\n            <img src={pinImgURL} width=\"12\" hidden={!destinationMarker} />\n          </Marker>\n          <div class=\"marker-pointer mini\" ref={markerPointerMiniRef} hidden />\n        </Map>\n        <div id=\"mini-actions\">\n          <button\n            type=\"button\"\n            onClick={() => {\n              setOverviewMapExpanded(!overviewMapExpanded);\n            }}\n          >\n            {overviewMapExpanded ? (\n              <svg height=\"24\" viewBox=\"0 0 24 24\" width=\"24\">\n                <path\n                  fill=\"currentColor\"\n                  d=\"m5 16h3v3h2v-5h-5zm3-8h-3v2h5v-5h-2zm6 11h2v-3h3v-2h-5zm2-11v-3h-2v5h5v-2z\"\n                />\n              </svg>\n            ) : (\n              <svg height=\"24\" viewBox=\"0 0 24 24\" width=\"24\">\n                <path\n                  fill=\"currentColor\"\n                  d=\"m7 14h-2v5h5v-2h-3zm-2-4h2v-3h3v-2h-5zm12 7h-3v2h5v-5h-2zm-3-12v2h3v3h2v-5z\"\n                />\n              </svg>\n            )}\n          </button>\n          {overviewMapExpanded && showMiniLocationButton && (\n            <button\n              type=\"button\"\n              onClick={() => {\n                overviewMapRef.current?.easeTo({\n                  center: geolocationGeoJSON.features[0].geometry.coordinates,\n                });\n              }}\n            >\n              <svg height=\"24\" viewBox=\"0 0 24 24\" width=\"24\">\n                <path\n                  fill=\"currentColor\"\n                  d=\"m12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94v-2.06h-2v2.06c-4.17.46-7.48 3.77-7.94 7.94h-2.06v2h2.06c.46 4.17 3.77 7.48 7.94 7.94v2.06h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94h2.06v-2zm-8.94 8c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z\"\n                />\n              </svg>\n            </button>\n          )}\n        </div>\n      </div>\n      <div class=\"bd\" onClick={(e) => e.stopPropagation()} hidden={!sheetOpen}>\n        <BottomSheet\n          open={aboutSheetOpen}\n          onDismiss={() => {\n            setAboutSheetOpen(false);\n            LS.set('not-first-time', true);\n          }}\n          initialFocusRef={aboutSheetInitialFocusRef}\n        >\n          <div class=\"bottom-sheet-container\">\n            <img\n              alt=\"\"\n              src={iconImgURL}\n              width=\"96\"\n              height=\"96\"\n              style={{\n                borderRadius: 24,\n                boxShadow: '0 1px 2px #ccc',\n                float: 'right',\n                marginLeft: 10,\n              }}\n            />\n            <h1>MapWalker</h1>\n            <p>\n              MapWalker is a very opinionated map-based walking route planner.\n            </p>\n            <p>\n              The map tiles and styles escalate <b>all</b> walking paths and\n              roads to the surface. They are color-coded based on their types,\n              such as stairs, bridges, tunnels, etc.\n            </p>\n            <p>\n              Once a marker is placed, walk routes can be generated from current\n              location to the marker. Up to 6 walk routes will be generated from\n              different routing engines, overlayed on the map simultaneuously\n              for comparison as each has its own pros and cons.\n            </p>\n            <p>\n              <a href=\"https://github.com/cheeaun/mapwalker\" target=\"_blank\">\n                Built\n              </a>{' '}\n              by{' '}\n              <a href=\"https://twitter.com/cheeaun\" target=\"_blank\">\n                @cheeaun\n              </a>\n              .\n            </p>\n            <button\n              type=\"button\"\n              class=\"block bold\"\n              ref={aboutSheetInitialFocusRef}\n              onClick={() => {\n                setAboutSheetOpen(false);\n                LS.set('not-first-time', true);\n              }}\n            >\n              <span>ðŸš¶</span> Start walking now!\n            </button>\n          </div>\n        </BottomSheet>\n        <BottomSheet\n          open={legendSheetOpen}\n          onDismiss={() => {\n            setLegendSheetOpen(false);\n          }}\n        >\n          <div class=\"bottom-sheet-container legend-sheet-container\">\n            <h2>Map Legend</h2>\n            <dl>\n              <dt>\n                <span class=\"path\" />\n              </dt>\n              <dd>Foot paths, cycling paths</dd>\n              <dt>\n                <span class=\"bridge\" />\n              </dt>\n              <dd>Bridges</dd>\n              <dt>\n                <span class=\"stairs\" />\n              </dt>\n              <dd>Stairs</dd>\n              <dt>\n                <span class=\"tunnel\" />\n              </dt>\n              <dd>Tunnels, underground paths, under bridge</dd>\n              <dt>\n                <img src={walkDotBlueImgURL} width=\"10\" height=\"10\" />\n              </dt>\n              <dd>\n                Route from OSRM\n                {distances.osrm?.map((dist) => (\n                  <>\n                    <br />\n                    <span class=\"insignificant\">{routeInfoText(dist)}</span>\n                  </>\n                ))}\n              </dd>\n              <dt>\n                <img src={walkDotPurpleImgURL} width=\"10\" height=\"10\" />\n              </dt>\n              <dd>\n                Route from OpenRouteService\n                {distances.ors?.map((dist) => (\n                  <>\n                    <br />\n                    <span class=\"insignificant\">{routeInfoText(dist)}</span>\n                  </>\n                ))}\n              </dd>\n              <dt>\n                <img src={walkDotRedImgURL} width=\"10\" height=\"10\" />\n              </dt>\n              <dd>\n                Route from GraphHopper\n                {distances.graphhopper?.map((dist) => (\n                  <>\n                    <br />\n                    <span class=\"insignificant\">{routeInfoText(dist)}</span>\n                  </>\n                ))}\n              </dd>\n            </dl>\n          </div>\n        </BottomSheet>\n        <BottomSheet\n          open={optionsSheetOpen}\n          onDismiss={() => {\n            setOptionsSheetOpen(false);\n          }}\n        >\n          <div class=\"bottom-sheet-container options-sheet-container\">\n            <h2>Options</h2>\n            <p>\n              <label>\n                Theme:{' '}\n                <select\n                  id=\"theme-switcher\"\n                  value={theme}\n                  onChange={(e) => {\n                    setTheme(e.target.value);\n                  }}\n                >\n                  <option value=\"auto\">Auto</option>\n                  <option value=\"light\">Light</option>\n                  <option value=\"dark\">Dark</option>\n                </select>\n              </label>\n            </p>\n            <p>\n              <label>\n                Unit system:{' '}\n                <select\n                  id=\"unit-system-switcher\"\n                  value={unitSystem}\n                  onChange={(e) => {\n                    setUnitSystem(e.target.value);\n                  }}\n                >\n                  <option value=\"metric\">Metric</option>\n                  <option value=\"imperial\">Imperial</option>\n                </select>\n              </label>\n            </p>\n          </div>\n        </BottomSheet>\n        <BottomSheet\n          open={markerSheetOpen}\n          onDismiss={() => {\n            setMarkerSheetOpen(false);\n          }}\n          initialFocusRef={markerSheetInitialFocusRef}\n        >\n          <div class=\"bottom-sheet-container marker-sheet-container\">\n            {!!destinationMarker && !!geolocationGeoJSON && (\n              <div\n                class=\"insignificant\"\n                style={{ width: '100%', textAlign: 'center' }}\n              >\n                Air distance to marker: {prettyUnit(airDistanceToMarker)}\n              </div>\n            )}\n            {!!destinationMarker ? (\n              <>\n                <button\n                  type=\"button\"\n                  onClick={() => {\n                    setDestinationMarker(null);\n                    backupDestinationMarker.current = destinationMarker;\n                    setMarkerPinned(false);\n                  }}\n                >\n                  <span>âŒ</span> Remove marker\n                </button>\n                <button\n                  type=\"button\"\n                  onClick={() => {\n                    setMarkerPinned(!markerPinned);\n                    setMarkerSheetOpen(false);\n                  }}\n                  class={markerPinned ? '' : 'faded'}\n                >\n                  <span>ðŸ“Œ</span> {markerPinned ? 'Unpin marker' : 'Pin marker'}\n                </button>\n                {!!walkRouteGeoJSON && (\n                  <button\n                    type=\"button\"\n                    onClick={() => {\n                      zoomWholeRoute(walkRouteGeoJSON);\n                      setMarkerSheetOpen(false);\n                    }}\n                  >\n                    <span>ðŸ”­</span> Zoom whole route\n                  </button>\n                )}\n                <button\n                  type=\"button\"\n                  onClick={() => {\n                    mapRef.current?.flyTo({\n                      center: destinationMarker,\n                    });\n                    setMarkerSheetOpen(false);\n                  }}\n                >\n                  <span>ðŸ”</span> Fly to marker\n                </button>\n                <button\n                  type=\"button\"\n                  class=\"bold block\"\n                  ref={markerSheetInitialFocusRef}\n                  onClick={async () => {\n                    setLoading(true);\n                    setMarkerSheetOpen(false);\n                    console.log({\n                      geolocationGeoJSON,\n                      destinationMarker,\n                    });\n                    if (!geolocationGeoJSON) {\n                      alert('Please allow location access to generate routes');\n                      return;\n                    }\n                    const results = await fetchRoutes(\n                      geolocationGeoJSON.features[0].geometry.coordinates,\n                      [destinationMarker.lng, destinationMarker.lat],\n                    );\n                    setWalkRouteGeoJSON(results);\n                    setLoading(false);\n                    setMarkerPinned(true);\n                    zoomWholeRoute(results);\n                  }}\n                >\n                  <span>ðŸ”ƒ</span> Generate walk routes to marker\n                </button>\n              </>\n            ) : (\n              <>\n                {!destinationMarker && (\n                  <button\n                    type=\"button\"\n                    onClick={() => {\n                      const center = mapRef.current?.getCenter();\n                      setDestinationMarker({\n                        lat: center.lat,\n                        lng: center.lng,\n                      });\n                      setMarkerSheetOpen(false);\n                    }}\n                  >\n                    <span>ðŸ“Œ</span> Place marker on map\n                  </button>\n                )}\n                {!destinationMarker && backupDestinationMarker.current && (\n                  <button\n                    type=\"button\"\n                    onClick={() => {\n                      setDestinationMarker(backupDestinationMarker.current);\n                    }}\n                  >\n                    <span>â™»ï¸</span> Restore marker\n                  </button>\n                )}\n                {!!walkRouteGeoJSON ? (\n                  <button\n                    type=\"button\"\n                    onClick={() => {\n                      backupWalkRouteGeoJSON.current = walkRouteGeoJSON;\n                      setWalkRouteGeoJSON(null);\n                    }}\n                  >\n                    <span>ðŸ—‘ï¸</span> Clear route\n                  </button>\n                ) : (\n                  backupWalkRouteGeoJSON.current && (\n                    <button\n                      type=\"button\"\n                      onClick={() => {\n                        setWalkRouteGeoJSON(backupWalkRouteGeoJSON.current);\n                      }}\n                    >\n                      <span>â™»ï¸</span> Restore route\n                    </button>\n                  )\n                )}\n              </>\n            )}\n          </div>\n        </BottomSheet>\n      </div>\n    </div>\n  );\n}\n","import { render } from 'preact';\nimport { App } from './app';\n\nimport 'mapbox-gl/dist/mapbox-gl.css';\nimport '@mapbox/mapbox-gl-geocoder/lib/mapbox-gl-geocoder.css';\nimport 'react-spring-bottom-sheet/dist/style.css';\nimport './index.css';\n\nrender(<App />, document.getElementById('app'));\n"],"names":["VITE_ORS_API_KEY","ORS_API_KEY","VITE_GRAPHHOPPER_API_KEY","GRAPHHOPPER_API_KEY","import","APIS","OSRM","origin","destination","join","ORS","GHOP","fetchRoutes","params","fetch1","fetch","URLSearchParams","geometries","overview","continue_straight","generate_hints","alternatives","then","r","json","catch","e","fetch2","method","headers","Authorization","body","JSON","stringify","coordinates","instructions","alternative_routes","target_count","fetch3Params","vehicle","key","points_encoded","point","reverse","algorithm","append","fetch3","response1","response2","response3","Promise","all","console","log","type","features","routes","map","route","index","geometry","properties","provider","distance","feature","summary","paths","path","points","LS_PREFIX","get","parse","localStorage","getItem","set","value","setItem","removeItem","del","jsxRuntime.jsx","jsxRuntime.jsxs","jsxRuntime.Fragment","VITE_MAPBOX_ACCESS_TOKEN","MAPBOX_ACCESS_TOKEN","DEV","OVERVIEW_ZOOM_BACK","POINTER_PADDING","MAPSTYLE","emptyGeoJSON","mapStyles","walkRoute","layout","paint","walkRoute2","orientationGranted","fn","window","DeviceOrientationEvent","requestPermission","permissionState","GeocoderControl","lazy","x1","y1","x2","y2","radians","Math","atan2","PI","document","querySelector","ms","resolve","setTimeout","mapDivRef","useRef","mapRef","overviewMapDivRef","overviewMapRef","loading","setLoading","useState","geolocateControlRef","geolocationGeoJSON","setGeolocationGeoJSON","walkRouteGeoJSON","setWalkRouteGeoJSON","LS","useEffect","destinationMarker","setDestinationMarker","markerPinned","setMarkerPinned","clickFired","mapHandleClickDebounced","AwesomeDebouncePromise","current","lngLat","mapTextLayerID","setMapTextLayerID","legendSheetOpen","setLegendSheetOpen","optionsSheetOpen","setOptionsSheetOpen","markerSheetOpen","setMarkerSheetOpen","aboutSheetOpen","setAboutSheetOpen","backupDestinationMarker","backupWalkRouteGeoJSON","distances","useMemo","info","forEach","push","sheetOpen","setSheetOpen","overviewMapExpanded","setOverviewMapExpanded","resize","aboutSheetInitialFocusRef","markerSheetInitialFocusRef","airDistanceToMarker","length","lng","lat","originLng","originLat","haversine","longitude","latitude","requestOrientationTriggerGeolocation","useCallback","hasHeading","requestOrientation","times","trigger","sleep","markerPointerRef","markerPointerMiniRef","mapRect","useRect","overviewMapRect","renderMapArrow","width","height","x","y","project","constrainedX","max","min","constrainedY","centerX","centerY","bearing","bearingDegrees","hidden","style","transform","renderOverviewMapArrow","geolocateState","setGeolocateActiveLock","usePageVisibility","visible","easeTo","center","zoomWholeRoute","routeGeoJSON","bounds","mapboxgl","LngLatBounds","coord","extend","fitBounds","padding","theme","setTheme","html","documentElement","colorSchemeMeta","classList","add","remove","setAttribute","unitSystem","setUnitSystem","prettyUnit","d","miles","prettyImperial","input","humanize","prettyMetric","routeInfoText","timeDurationSecs","humanizeDuration","units","round","showMiniLocationButton","setShowMiniLocationButton","_jsxs","_jsx","layers","getStyle","find","layer","id","loadImage","walkDotBlueImgURL","error","image","addImage","walkDotPurpleImgURL","walkDotRedImgURL","geolocateSource","target","getCenter","viewState","zoom","getZoom","getBearing","pitch","getPitch","hideNavControl","display","lowZoomLevel","jumpTo","originalEvent","detail","stopPropagation","pinImgURL","Suspense","enableHighAccuracy","timeout","_watchState","coords","onGeolocate","code","message","isInBounds","overviewMapBounds","getBounds","contains","BottomSheet","iconImgURL","borderRadius","boxShadow","float","marginLeft","osrm","dist","_Fragment","ors","graphhopper","textAlign","flyTo","alert","results","render","getElementById"],"mappings":"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"}