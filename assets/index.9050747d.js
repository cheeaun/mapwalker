var Q=Object.defineProperty,N=Object.defineProperties;var x=Object.getOwnPropertyDescriptors;var B=Object.getOwnPropertySymbols;var K=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable;var j=(t,e,a)=>e in t?Q(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a,y=(t,e)=>{for(var a in e||(e={}))K.call(e,a)&&j(t,a,e[a]);if(B)for(var a of B(e))J.call(e,a)&&j(t,a,e[a]);return t},D=(t,e)=>N(t,x(e));import{j as M,a as F,F as Y,s as v,l as S,y as b,A as q,M as T,b as X,N as W,G as Z,S as C,L as z,c as V,u as _,d as $,e as ee}from"./vendor.ae71023e.js";const te=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))m(i);new MutationObserver(i=>{for(const c of i)if(c.type==="childList")for(const u of c.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&m(u)}).observe(document,{childList:!0,subtree:!0});function a(i){const c={};return i.integrity&&(c.integrity=i.integrity),i.referrerpolicy&&(c.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?c.credentials="include":i.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function m(i){if(i.ep)return;i.ep=!0;const c=a(i);fetch(i.href,c)}};te();const{VITE_ORS_API_KEY:oe,VITE_GRAPHHOPPER_API_KEY:ne}={VITE_MAPBOX_ACCESS_TOKEN:"pk.eyJ1IjoiY2hlZWF1biIsImEiOiJjbDBkdXJud3gwY21qM2Rtenk1ZTM4dzNqIn0.lIVOhBl1NrdplE6DrbEngw",VITE_ORS_API_KEY:"5b3ce3597851110001cf624888ac0dd0f3434a208374935e71ad9bcd",VITE_GRAPHHOPPER_API_KEY:"LijBPDQGfu7Iiq80w3HzwB4RUDJbMbhs6BU0dEnn",BASE_URL:"./",MODE:"production",DEV:!1,PROD:!0},w={OSM_DE:(t,e)=>`https://routing.openstreetmap.de/routed-foot/route/v1/driving/${t.join(",")};${e.join(",")}`,ORS:()=>"https://api.openrouteservice.org/v2/directions/foot-hiking/geojson",GHOP:()=>"https://graphhopper.com/api/1/route"},re=async(t,e,a)=>{var h,g,P;const m=fetch(w.OSM_DE(t,e)+"?"+new URLSearchParams(y({geometries:"geojson",overview:"full",continue_straight:!1},a))).then(s=>s.json()).catch(s=>{}),i=fetch(w.ORS(),{method:"POST",headers:{"Content-Type":"application/json",Authorization:oe},body:JSON.stringify({coordinates:[t,e],instructions:!1})}).then(s=>s.json()).catch(s=>{}),c=new URLSearchParams({vehicle:"foot",key:ne,instructions:!0,points_encoded:!1,point:[...t].reverse().join(",")});c.append("point",[...e].reverse().join(","));const u=fetch(w.GHOP()+"?"+c).then(s=>s.json()).catch(s=>{}),[A,d,f]=await Promise.all([m,i,u]);return console.log({response1:A,response2:d,response3:f}),{type:"FeatureCollection",features:[{type:"Feature",geometry:(h=A==null?void 0:A.routes[0])==null?void 0:h.geometry,properties:{index:0,provider:"osm-de"}},{type:"Feature",geometry:(g=d==null?void 0:d.features[0])==null?void 0:g.geometry,properties:{index:1,provider:"ors"}},{type:"Feature",geometry:(P=f==null?void 0:f.paths[0])==null?void 0:P.points,properties:{index:2,provider:"graphhopper"}}]}},k="mapwalker-";var p={get:t=>{try{return JSON.parse(localStorage.getItem(k+t))}catch{return null}},set:(t,e)=>{try{e?localStorage.setItem(k+t,JSON.stringify(e)):localStorage.removeItem(k+t)}catch{}},del:t=>{try{localStorage.removeItem(k+t)}catch{}}},H="data:image/png;base64,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";const n=M,O=F,U=Y,{VITE_MAPBOX_ACCESS_TOKEN:R}={VITE_MAPBOX_ACCESS_TOKEN:"pk.eyJ1IjoiY2hlZWF1biIsImEiOiJjbDBkdXJud3gwY21qM2Rtenk1ZTM4dzNqIn0.lIVOhBl1NrdplE6DrbEngw",VITE_ORS_API_KEY:"5b3ce3597851110001cf624888ac0dd0f3434a208374935e71ad9bcd",VITE_GRAPHHOPPER_API_KEY:"LijBPDQGfu7Iiq80w3HzwB4RUDJbMbhs6BU0dEnn",BASE_URL:"./",MODE:"production",DEV:!1,PROD:!0},ie=2;function ae(t){return _(()=>new $(t),{position:t.position}),null}const G={type:"FeatureCollection",features:[]};function ce(){const t=v(),e=v(),a=v(),[m,i]=S(!1),c=v(),[u,A]=S(G),[d,f]=S(p.get("walk-route")||null);b(()=>{p.set("walk-route",d)},[d]);const[o,h]=S(p.get("destination-marker")||null);b(()=>{p.set("destination-marker",o)},[o]);const[g,P]=S(p.get("marker-pinned")||!1);b(()=>{p.set("marker-pinned",g)},[g]);const s={walkRoute:{layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":["case",["==",["get","provider"],"ors"],"#95378C",["==",["get","provider"],"graphhopper"],"#EB1E4E","#0E90DF"],"line-opacity":["interpolate",["linear"],["zoom"],15,1,18,.5],"line-width":["interpolate",["linear"],["zoom"],15,4,18,14],"line-dasharray":[0,2]}}},L=q(r=>{if(console.log("map click",r),r.originalEvent.detail>1||o)return;const{lngLat:l}=r;h(l)},350);return O(U,{children:[n("div",{id:"map",children:O(T,{ref:t,mapboxAccessToken:R,mapStyle:"mapbox://styles/cheeaun/cl0ds1jbz003014px6nthvdle/draft",initialViewState:p.get("view-state")||{center:[103.8198,1.3521]},boxZoom:!1,renderWorldCopies:!1,maxZoom:21,attributionControl:!1,logoPosition:"top-right",onLoad:r=>{var l;(l=c.current)==null||l.trigger()},onMoveStart:r=>{r.geolocateSource||e.current.hidden||e.current.classList.add("faded")},onMoveEnd:r=>{r.geolocateSource||e.current.hidden||(e.current.classList.remove("faded"),p.set("view-state",r.viewState))},onMove:r=>{var I;const{viewState:l}=r,E=l.zoom<16;e.current.hidden=E,E||(I=a.current)==null||I.jumpTo(D(y({},l),{center:[l.longitude,l.latitude],zoom:l.zoom-ie}))},onClick:L,children:[n(X,{position:"top-right",compact:!0}),n(ae,{accessToken:R,marker:!1,clearAndBlurOnSelect:!0,collapsed:!0,position:"top-left"}),n(W,{visualizePitch:!0,position:"top-right"}),n(Z,{ref:c,fitBoundsOptions:{zoom:17},positionOptions:{enableHighAccuracy:!0,timeout:3e3},trackUserLocation:!0,showUserHeading:!0,position:"top-right",onGeolocate:r=>{console.log({onGeolocate:r});const{coords:l}=r;A({type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Point",coordinates:[l.longitude,l.latitude]}}]}),window.DeviceOrientationEvent&&!orientationGranted&&typeof DeviceOrientationEvent.requestPermission=="function"&&DeviceOrientationEvent.requestPermission().then(function(E){E==="granted"&&(console.log("granted"),orientationGranted=!0)}).catch(E=>{})}}),n(C,{id:"walk-route",type:"geojson",data:d||G,children:n(z,y({id:"walk-route",type:"line"},s.walkRoute))}),n(V,{anchor:"bottom",draggable:!g,longitude:(o==null?void 0:o.lng)||0,latitude:(o==null?void 0:o.lat)||0,onDragEnd:r=>{const{lngLat:l}=r;h(l)},children:n("img",{src:H,width:"18",hidden:!o})})]})}),n("div",{id:"overview-map",ref:e,hidden:!0,children:O(T,{ref:a,mapboxAccessToken:R,mapStyle:"mapbox://styles/cheeaun/cl0ds1jbz003014px6nthvdle/draft",initialViewState:{center:[103.8198,1.3521],zoom:11},attributionControl:!1,interactive:!1,maxZoom:16,minZoom:14.5,children:[n(C,{id:"walk-route",type:"geojson",data:d||G,children:n(z,y({id:"walk-route",type:"line"},s.walkRoute))}),O(C,{id:"geolocation",type:"geojson",data:u,children:[n(z,{id:"geolocation-outer",type:"circle",paint:{"circle-radius":5,"circle-color":"#1ea1f1"}}),n(z,{id:"geolocation-inner",type:"circle",paint:{"circle-radius":3,"circle-color":"#1ea1f1","circle-stroke-width":1,"circle-stroke-color":"#fff"}})]}),n(V,{anchor:"bottom",longitude:(o==null?void 0:o.lng)||0,latitude:(o==null?void 0:o.lat)||0,children:n("img",{src:H,width:"10",hidden:!o})})]})}),O("div",{id:"actions",class:m?"disabled":"",children:[m&&n("div",{class:"loading"}),o?O(U,{children:[n("button",{type:"button",onClick:()=>{h(null),P(!1)},title:"Remove marker",children:"\u274C"}),n("button",{type:"button",onClick:()=>{P(!g)},class:g?"":"faded",title:g?"Unpin marker":"Pin marker",children:"\u{1F4CC}"}),n("button",{type:"button",onClick:()=>{var r;(r=t.current)==null||r.flyTo({center:o})},title:"Fly to marker",children:"\u{1F50D}"}),n("button",{type:"button",onClick:async()=>{i(!0),console.log({geolocationGeoJSON:u,destinationMarker:o});const r=await re(u.features[0].geometry.coordinates,[o.lng,o.lat]);f(r),i(!1),P(!0)},title:"Generate route to marker",children:"\u{1F503}"})]}):!!d&&n("button",{type:"button",onClick:()=>{f(null)},title:"Clear route",children:"\u274C\u{1F504}"})]})]})}ee(n(ce,{}),document.getElementById("app"));
