var D=Object.defineProperty,G=Object.defineProperties;var M=Object.getOwnPropertyDescriptors;var L=Object.getOwnPropertySymbols;var B=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable;var A=(t,e,i)=>e in t?D(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i,O=(t,e)=>{for(var i in e||(e={}))B.call(e,i)&&A(t,i,e[i]);if(L)for(var i of L(e))J.call(e,i)&&A(t,i,e[i]);return t},F=(t,e)=>G(t,M(e));import{j as V,a as z,F as K,s as E,l as b,y as k,M as N,A as X,N as Z,G as U,S as _,L as w,b as x,u as Y,c as q,d as W}from"./vendor.977f75c3.js";const $=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))h(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const u of a.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&h(u)}).observe(document,{childList:!0,subtree:!0});function i(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerpolicy&&(a.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?a.credentials="include":n.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function h(n){if(n.ep)return;n.ep=!0;const a=i(n);fetch(n.href,a)}};$();const{VITE_ORS_API_KEY:H}={VITE_MAPBOX_ACCESS_TOKEN:"pk.eyJ1IjoiY2hlZWF1biIsImEiOiJjbDBkdXJud3gwY21qM2Rtenk1ZTM4dzNqIn0.lIVOhBl1NrdplE6DrbEngw",VITE_ORS_API_KEY:"5b3ce3597851110001cf624888ac0dd0f3434a208374935e71ad9bcd",BASE_URL:"./",MODE:"production",DEV:!1,PROD:!0},C={OSM_DE:(t,e)=>`https://routing.openstreetmap.de/routed-foot/route/v1/driving/${t.join(",")};${e.join(",")}`,ORS:()=>"https://api.openrouteservice.org/v2/directions/foot-hiking/geojson",GHOP:()=>"https://graphhopper.com/api/1/route"},Q=async(t,e,i)=>{var y,p,S;const h=fetch(C.OSM_DE(t,e)+"?"+new URLSearchParams(O({geometries:"geojson",overview:"full",continue_straight:!1},i))).then(s=>s.json()).catch(s=>{}),n=fetch(C.ORS(),{method:"POST",headers:{"Content-Type":"application/json",Authorization:H},body:JSON.stringify({coordinates:[t,e],instructions:!1})}).then(s=>s.json()).catch(s=>{}),a=new URLSearchParams({vehicle:"foot",key:"LijBPDQGfu7Iiq80w3HzwB4RUDJbMbhs6BU0dEnn",instructions:!0,points_encoded:!1,point:[...t].reverse().join(",")});a.append("point",[...e].reverse().join(","));const u=fetch(C.GHOP()+"?"+a).then(s=>s.json()).catch(s=>{}),[g,d,m]=await Promise.all([h,n,u]);return console.log({response1:g,response2:d,response3:m}),{type:"FeatureCollection",features:[{type:"Feature",geometry:(y=g==null?void 0:g.routes[0])==null?void 0:y.geometry,properties:{index:0,provider:"osm-de"}},{type:"Feature",geometry:(p=d==null?void 0:d.features[0])==null?void 0:p.geometry,properties:{index:1,provider:"ors"}},{type:"Feature",geometry:(S=m==null?void 0:m.paths[0])==null?void 0:S.points,properties:{index:2,provider:"graphhopper"}}]}};var f={get:t=>{try{return JSON.parse(localStorage.getItem(LS_PREFIX+t))}catch{return null}},set:(t,e)=>{try{e?localStorage.setItem(LS_PREFIX+t,JSON.stringify(e)):localStorage.removeItem(LS_PREFIX+t)}catch{}},del:t=>{try{localStorage.removeItem(LS_PREFIX+t)}catch{}}};const r=V,v=z,T=K,{VITE_MAPBOX_ACCESS_TOKEN:I}={VITE_MAPBOX_ACCESS_TOKEN:"pk.eyJ1IjoiY2hlZWF1biIsImEiOiJjbDBkdXJud3gwY21qM2Rtenk1ZTM4dzNqIn0.lIVOhBl1NrdplE6DrbEngw",VITE_ORS_API_KEY:"5b3ce3597851110001cf624888ac0dd0f3434a208374935e71ad9bcd",BASE_URL:"./",MODE:"production",DEV:!1,PROD:!0},ee=2;function te(t){return Y(()=>new q(t),{position:t.position}),null}const P={type:"FeatureCollection",features:[]};function oe(){const t=E(),e=E(),i=E(),[h,n]=b(!1),a=E(),[u,g]=b(P),[d,m]=b(f.get("walk-route")||null);k(()=>{f.set("walk-route",d)},[d]);const[o,y]=b(f.get("destination-marker")||null);k(()=>{f.set("destination-marker",o)},[o]);const[p,S]=b(f.get("marker-pinned")||!1);k(()=>{f.set("marker-pinned",p)},[p]);const s={walkRoute:{layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#0e90df","line-opacity":.75,"line-width":["interpolate",["linear"],["zoom"],15,4,18,12],"line-dasharray":[0,2]}}};return v(T,{children:[r("div",{id:"map",children:v(N,{ref:t,mapboxAccessToken:I,mapStyle:"mapbox://styles/cheeaun/cl0ds1jbz003014px6nthvdle/draft",initialViewState:f.get("view-state")||{center:[103.8198,1.3521]},boxZoom:!1,renderWorldCopies:!1,maxZoom:21,attributionControl:!1,logoPosition:"top-right",onLoad:l=>{var c;(c=a.current)==null||c.trigger()},onMoveStart:()=>{e.current.hidden||e.current.classList.add("faded")},onMoveEnd:l=>{e.current.hidden||(e.current.classList.remove("faded"),f.set("view-state",l.viewState))},onMove:l=>{var j;const{viewState:c}=l,R=c.zoom<16;e.current.hidden=R,R||(j=i.current)==null||j.jumpTo(F(O({},c),{center:[c.longitude,c.latitude],zoom:c.zoom-ee}))},onClick:l=>{if(o)return;const{lngLat:c}=l;y(c)},children:[r(X,{position:"top-right",compact:!0}),r(te,{accessToken:I,marker:!1,clearAndBlurOnSelect:!0,collapsed:!0,position:"top-left"}),r(Z,{visualizePitch:!0,position:"top-right"}),r(U,{ref:a,fitBoundsOptions:{zoom:17},positionOptions:{enableHighAccuracy:!0,timeout:3e3},trackUserLocation:!0,showUserLocation:!0,position:"top-right",onGeolocate:l=>{console.log({onGeolocate:l});const{coords:c}=l;g({type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Point",coordinates:[c.longitude,c.latitude]}}]})}}),r(_,{id:"walk-route",type:"geojson",data:d||P,children:r(w,O({id:"walk-route",type:"line"},s.walkRoute))}),r(x,{anchor:"bottom",draggable:!p,longitude:(o==null?void 0:o.lng)||0,latitude:(o==null?void 0:o.lat)||0,onDragEnd:l=>{const{lngLat:c}=l;y(c)},children:r("img",{src:"../assets/pin.png",width:"18",hidden:!o})})]})}),r("div",{id:"overview-map",ref:e,hidden:!0,children:v(N,{ref:i,mapboxAccessToken:I,mapStyle:"mapbox://styles/cheeaun/cl0ds1jbz003014px6nthvdle/draft",initialViewState:{center:[103.8198,1.3521],zoom:11},attributionControl:!1,interactive:!1,maxZoom:16,minZoom:14.5,children:[r(_,{id:"walk-route",type:"geojson",data:d||P,children:r(w,O({id:"walk-route",type:"line"},s.walkRoute))}),v(_,{id:"geolocation",type:"geojson",data:u,children:[r(w,{id:"geolocation-outer",type:"circle",paint:{"circle-radius":5,"circle-color":"#1ea1f1"}}),r(w,{id:"geolocation-inner",type:"circle",paint:{"circle-radius":3,"circle-color":"#1ea1f1","circle-stroke-width":1,"circle-stroke-color":"#fff"}})]}),r(x,{anchor:"bottom",longitude:(o==null?void 0:o.lng)||0,latitude:(o==null?void 0:o.lat)||0,children:r("img",{src:"../assets/pin.png",width:"10",hidden:!o})})]})}),v("div",{id:"actions",children:[h&&r("div",{class:"loading"}),o?v(T,{children:[r("button",{type:"button",onClick:()=>{y(null),S(!1)},title:"Remove marker",children:"\u274C"}),r("button",{type:"button",onClick:()=>{S(!p)},class:p?"":"faded",title:p?"Unpin marker":"Pin marker",children:"\u{1F4CC}"}),r("button",{type:"button",onClick:()=>{var l;(l=t.current)==null||l.flyTo({center:o})},title:"Fly to marker",children:"\u{1F50D}"}),r("button",{type:"button",onClick:async()=>{n(!0),console.log({geolocationGeoJSON:u,destinationMarker:o});const l=await Q(u.features[0].geometry.coordinates,[o.lng,o.lat]);m(l),n(!1),S(!0)},title:"Generate route to marker",children:"\u{1F503}"})]}):!!d&&r("button",{type:"button",onClick:()=>{m(null)},title:"Clear route",children:"\u274C\u{1F504}"})]})]})}W(r(oe,{}),document.getElementById("app"));
